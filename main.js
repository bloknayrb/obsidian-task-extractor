/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TaskExtractorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/types.ts
var DEFAULT_FRONTMATTER_FIELDS = [
  { key: "task", defaultValue: "", type: "text", required: true },
  { key: "status", defaultValue: "inbox", type: "select", options: ["inbox", "next", "waiting", "someday", "done", "cancelled"], required: true },
  { key: "priority", defaultValue: "medium", type: "select", options: ["low", "medium", "high", "urgent"], required: true },
  { key: "due", defaultValue: "", type: "date", required: false },
  { key: "project", defaultValue: "", type: "text", required: false },
  { key: "client", defaultValue: "", type: "text", required: false },
  { key: "created", defaultValue: "{{date}}", type: "date", required: true },
  { key: "tags", defaultValue: "task", type: "text", required: false }
];
var DEFAULT_SETTINGS = {
  provider: "openai",
  apiKey: "",
  model: "gpt-4o-mini",
  // Local LLM settings
  ollamaUrl: "http://localhost:11434",
  lmstudioUrl: "http://localhost:1234",
  localModelRefreshInterval: 5,
  // Processing settings
  tasksFolder: "Tasks",
  linkBack: true,
  processedFrontmatterKey: "taskExtractor.processed",
  ownerName: "Bryan Kolb",
  processOnUpdate: false,
  triggerTypes: ["email", "meetingnote", "meeting note", "meeting notes"],
  // Customizable frontmatter
  frontmatterFields: DEFAULT_FRONTMATTER_FIELDS,
  customPrompt: "",
  // Advanced settings
  maxTokens: 800,
  temperature: 0,
  timeout: 30,
  retries: 3
};

// src/llm-providers.ts
var import_obsidian = require("obsidian");
var LLMProviderManager = class {
  constructor(settings) {
    this.settings = settings;
    this.serviceCache = /* @__PURE__ */ new Map();
    this.cloudModelCache = /* @__PURE__ */ new Map();
    this.apiKeyMissingNotified = /* @__PURE__ */ new Set();
  }
  // Get service with 30-minute cache TTL
  async getService(provider) {
    const cached = this.serviceCache.get(provider);
    const now = Date.now();
    const cacheValidMs = 30 * 60 * 1e3;
    if (cached && now - cached.lastChecked < cacheValidMs) {
      return cached;
    }
    return await this.detectSingleService(provider);
  }
  // Detect a single service instead of all services
  async detectSingleService(provider) {
    var _a, _b;
    const now = Date.now();
    if (provider === "ollama") {
      const service = {
        name: "ollama",
        url: this.settings.ollamaUrl,
        available: false,
        models: [],
        lastChecked: now
      };
      try {
        const rawResponse = await (0, import_obsidian.requestUrl)({
          url: `${this.settings.ollamaUrl}/api/tags`,
          method: "GET"
        });
        const response = this.adaptRequestUrlResponse(rawResponse);
        if (response.ok) {
          const data = await response.json();
          service.available = true;
          service.models = ((_a = data.models) == null ? void 0 : _a.map((m) => m.name)) || [];
        }
      } catch (error) {
        console.log("Ollama not available:", error.message);
      }
      this.serviceCache.set("ollama", service);
      return service;
    }
    if (provider === "lmstudio") {
      const service = {
        name: "lmstudio",
        url: this.settings.lmstudioUrl,
        available: false,
        models: [],
        lastChecked: now
      };
      try {
        const rawResponse = await (0, import_obsidian.requestUrl)({
          url: `${this.settings.lmstudioUrl}/v1/models`,
          method: "GET"
        });
        const response = this.adaptRequestUrlResponse(rawResponse);
        if (response.ok) {
          const data = await response.json();
          service.available = true;
          service.models = ((_b = data.data) == null ? void 0 : _b.map((m) => m.id)) || [];
        }
      } catch (error) {
        console.log("LM Studio not available:", error.message);
      }
      this.serviceCache.set("lmstudio", service);
      return service;
    }
    return null;
  }
  // Legacy method for backward compatibility
  async detectServices() {
    await this.getService("ollama");
    await this.getService("lmstudio");
    return this.serviceCache;
  }
  getAvailableServices() {
    return Array.from(this.serviceCache.values()).filter((s) => s.available);
  }
  // Provider-agnostic LLM call with fallback support
  async callLLM(systemPrompt, userPrompt) {
    const provider = this.settings.provider;
    if (["openai", "anthropic"].includes(provider) && !this.settings.apiKey) {
      const notificationKey = `${provider}-no-api-key`;
      if (!this.apiKeyMissingNotified.has(notificationKey)) {
        console.warn(`Task Extractor: ${provider.toUpperCase()} API key not configured in plugin settings`);
        this.apiKeyMissingNotified.add(notificationKey);
      }
      return null;
    }
    if (this.settings.apiKey) {
      this.apiKeyMissingNotified.delete(`${provider}-no-api-key`);
    }
    for (let attempt = 0; attempt < this.settings.retries; attempt++) {
      try {
        let result = null;
        switch (provider) {
          case "openai":
            result = await this.callOpenAI(systemPrompt, userPrompt);
            break;
          case "anthropic":
            result = await this.callAnthropic(systemPrompt, userPrompt);
            break;
          case "ollama":
            result = await this.callOllama(systemPrompt, userPrompt);
            break;
          case "lmstudio":
            result = await this.callLMStudio(systemPrompt, userPrompt);
            break;
          default:
            throw new Error(`Unsupported provider: ${provider}`);
        }
        if (result)
          return result;
      } catch (error) {
        console.warn(`Attempt ${attempt + 1} failed for ${provider}:`, error.message);
        if (attempt === this.settings.retries - 1) {
          if (["ollama", "lmstudio"].includes(provider)) {
            return await this.tryLocalFallback(systemPrompt, userPrompt);
          }
        } else {
          await this.delay(1e3 * (attempt + 1));
        }
      }
    }
    return null;
  }
  async tryLocalFallback(systemPrompt, userPrompt) {
    const availableServices = this.getAvailableServices();
    for (const service of availableServices) {
      if (service.name === this.settings.provider)
        continue;
      try {
        console.log(`Trying fallback to ${service.name}`);
        if (service.name === "ollama") {
          return await this.callOllama(systemPrompt, userPrompt);
        } else if (service.name === "lmstudio") {
          return await this.callLMStudio(systemPrompt, userPrompt);
        }
      } catch (error) {
        console.warn(`Fallback to ${service.name} failed:`, error.message);
      }
    }
    console.warn("Task Extractor: All LLM services failed. Check your configuration.");
    return null;
  }
  async callOpenAI(systemPrompt, userPrompt) {
    var _a, _b, _c;
    const endpoint = "https://api.openai.com/v1/chat/completions";
    const body = {
      model: this.settings.model || "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: userPrompt }
      ],
      temperature: this.settings.temperature,
      max_tokens: this.settings.maxTokens
    };
    try {
      const rawResp = await (0, import_obsidian.requestUrl)({
        url: endpoint,
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.settings.apiKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(body)
      });
      const resp = this.adaptRequestUrlResponse(rawResp);
      if (!resp.ok) {
        const text = await resp.text();
        console.error("OpenAI error", resp.status, text);
        throw new Error(`OpenAI API error: ${resp.status} ${resp.statusText}`);
      }
      const json = await resp.json();
      return ((_c = (_b = (_a = json == null ? void 0 : json.choices) == null ? void 0 : _a[0]) == null ? void 0 : _b.message) == null ? void 0 : _c.content) || null;
    } catch (e) {
      console.error("callOpenAI error", e);
      throw e;
    }
  }
  async callAnthropic(systemPrompt, userPrompt) {
    var _a, _b;
    const endpoint = "https://api.anthropic.com/v1/messages";
    try {
      const rawResp = await (0, import_obsidian.requestUrl)({
        url: endpoint,
        method: "POST",
        headers: {
          "x-api-key": this.settings.apiKey,
          "Content-Type": "application/json",
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: this.settings.model || "claude-3-sonnet-20240229",
          max_tokens: this.settings.maxTokens,
          temperature: this.settings.temperature,
          system: systemPrompt,
          messages: [{
            role: "user",
            content: userPrompt
          }]
        })
      });
      const resp = this.adaptRequestUrlResponse(rawResp);
      if (!resp.ok) {
        const text = await resp.text();
        console.error("Anthropic error", resp.status, text);
        throw new Error(`Anthropic API error: ${resp.status} ${resp.statusText}`);
      }
      const json = await resp.json();
      return ((_b = (_a = json == null ? void 0 : json.content) == null ? void 0 : _a[0]) == null ? void 0 : _b.text) || null;
    } catch (e) {
      console.error("callAnthropic error", e);
      throw e;
    }
  }
  async callOllama(systemPrompt, userPrompt) {
    var _a;
    const service = await this.getService("ollama");
    if (!(service == null ? void 0 : service.available) || !service.models.length) {
      throw new Error("Ollama service not available or no models loaded");
    }
    const model = service.models.includes(this.settings.model) ? this.settings.model : service.models[0];
    const endpoint = `${this.settings.ollamaUrl}/api/chat`;
    try {
      const rawResp = await (0, import_obsidian.requestUrl)({
        url: endpoint,
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model,
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: userPrompt }
          ],
          stream: false,
          options: {
            temperature: this.settings.temperature,
            num_predict: this.settings.maxTokens
          }
        })
      });
      const resp = this.adaptRequestUrlResponse(rawResp);
      if (!resp.ok) {
        const text = await resp.text();
        console.error("Ollama error", resp.status, text);
        throw new Error(`Ollama API error: ${resp.status} ${resp.statusText}`);
      }
      const json = await resp.json();
      return ((_a = json == null ? void 0 : json.message) == null ? void 0 : _a.content) || null;
    } catch (e) {
      console.error("callOllama error", e);
      throw e;
    }
  }
  async callLMStudio(systemPrompt, userPrompt) {
    var _a, _b, _c;
    const service = await this.getService("lmstudio");
    if (!(service == null ? void 0 : service.available) || !service.models.length) {
      throw new Error("LM Studio service not available or no models loaded");
    }
    const model = service.models.includes(this.settings.model) ? this.settings.model : service.models[0];
    const endpoint = `${this.settings.lmstudioUrl}/v1/chat/completions`;
    try {
      const rawResp = await (0, import_obsidian.requestUrl)({
        url: endpoint,
        method: "POST",
        headers: {
          "Authorization": "Bearer lm-studio",
          // Placeholder auth
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model,
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: userPrompt }
          ],
          temperature: this.settings.temperature,
          max_tokens: this.settings.maxTokens
        })
      });
      const resp = this.adaptRequestUrlResponse(rawResp);
      if (!resp.ok) {
        const text = await resp.text();
        console.error("LM Studio error", resp.status, text);
        throw new Error(`LM Studio API error: ${resp.status} ${resp.statusText}`);
      }
      const json = await resp.json();
      return ((_c = (_b = (_a = json == null ? void 0 : json.choices) == null ? void 0 : _a[0]) == null ? void 0 : _b.message) == null ? void 0 : _c.content) || null;
    } catch (e) {
      console.error("callLMStudio error", e);
      throw e;
    }
  }
  // Fetch available models for cloud providers
  async fetchCloudModels(provider) {
    if (!this.settings.apiKey) {
      return [];
    }
    const cacheKey = `${provider}-${this.settings.apiKey.slice(-4)}`;
    if (this.cloudModelCache.has(cacheKey)) {
      return this.cloudModelCache.get(cacheKey) || [];
    }
    try {
      if (provider === "openai") {
        return await this.fetchOpenAIModels();
      } else if (provider === "anthropic") {
        return await this.fetchAnthropicModels();
      }
    } catch (error) {
      console.warn(`Failed to fetch ${provider} models:`, error.message);
      return this.getDefaultModels(provider);
    }
    return [];
  }
  async fetchOpenAIModels() {
    var _a, _b, _c;
    const rawResponse = await (0, import_obsidian.requestUrl)({
      url: "https://api.openai.com/v1/models",
      method: "GET",
      headers: {
        "Authorization": `Bearer ${this.settings.apiKey}`,
        "Content-Type": "application/json"
      }
    });
    const response = this.adaptRequestUrlResponse(rawResponse);
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.status}`);
    }
    const data = await response.json();
    const models = ((_c = (_b = (_a = data.data) == null ? void 0 : _a.filter((model) => model.id.includes("gpt") && !model.id.includes("instruct"))) == null ? void 0 : _b.map((model) => model.id)) == null ? void 0 : _c.sort()) || [];
    const cacheKey = `openai-${this.settings.apiKey.slice(-4)}`;
    this.cloudModelCache.set(cacheKey, models);
    return models.length > 0 ? models : this.getDefaultModels("openai");
  }
  async fetchAnthropicModels() {
    const knownModels = [
      "claude-3-5-sonnet-20241022",
      "claude-3-5-haiku-20241022",
      "claude-3-opus-20240229",
      "claude-3-sonnet-20240229",
      "claude-3-haiku-20240307"
    ];
    const cacheKey = `anthropic-${this.settings.apiKey.slice(-4)}`;
    this.cloudModelCache.set(cacheKey, knownModels);
    return knownModels;
  }
  getDefaultModels(provider) {
    const defaults = {
      openai: ["gpt-4o", "gpt-4o-mini", "gpt-4-turbo", "gpt-3.5-turbo"],
      anthropic: ["claude-3-5-sonnet-20241022", "claude-3-haiku-20240307"],
      ollama: ["llama3.2", "mistral", "codellama"],
      lmstudio: ["local-model"]
    };
    return defaults[provider] || [];
  }
  // Utility methods
  delay(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
  }
  createTimeoutSignal(ms) {
    const controller = new AbortController();
    setTimeout(() => controller.abort(), ms);
    return controller.signal;
  }
  // Cleanup method
  cleanup() {
    this.cloudModelCache.clear();
    this.apiKeyMissingNotified.clear();
    this.serviceCache.clear();
  }
  // Helper to adapt requestUrl response to fetch-like interface
  adaptRequestUrlResponse(response) {
    return {
      ok: response.status >= 200 && response.status < 300,
      status: response.status,
      statusText: response.status.toString(),
      json: async () => response.json,
      text: async () => response.text
    };
  }
  // Methods for backward compatibility
  getServiceCache() {
    return this.serviceCache;
  }
  getCloudModelCache() {
    return this.cloudModelCache;
  }
  getApiKeyMissingNotified() {
    return this.apiKeyMissingNotified;
  }
};

// src/task-processor.ts
var import_obsidian2 = require("obsidian");
var TaskProcessor = class {
  constructor(app, settings, llmProvider) {
    this.app = app;
    this.settings = settings;
    this.llmProvider = llmProvider;
    this.processingFiles = /* @__PURE__ */ new Set();
    this.fileChangeDebouncer = /* @__PURE__ */ new Map();
    this.processingQueue = /* @__PURE__ */ new Map();
  }
  // Debounce file changes to prevent rapid processing
  debounceFileChange(file, callback) {
    const existing = this.fileChangeDebouncer.get(file.path);
    if (existing) {
      clearTimeout(existing);
    }
    this.fileChangeDebouncer.set(file.path, setTimeout(() => {
      callback(file);
      this.fileChangeDebouncer.delete(file.path);
    }, 2e3));
  }
  // When a file is created or modified
  async onFileChanged(file) {
    if (file.extension !== "md")
      return;
    const queueStatus = this.processingQueue.get(file.path);
    if ((queueStatus == null ? void 0 : queueStatus.status) === "processing" || this.processingFiles.has(file.path)) {
      return;
    }
    const processingStatus = {
      status: "queued",
      startTime: Date.now()
    };
    processingStatus.timeout = setTimeout(() => {
      console.warn(`TaskExtractor: File processing timeout for ${file.path}`);
      this.cleanupFileProcessing(file.path);
    }, 3e4);
    this.processingQueue.set(file.path, processingStatus);
    this.processingFiles.add(file.path);
    processingStatus.status = "processing";
    try {
      const cache = this.app.metadataCache.getFileCache(file);
      const front = cache == null ? void 0 : cache.frontmatter;
      if (!front) {
        return;
      }
      const processedValue = this.getFrontmatterValue(front, this.settings.processedFrontmatterKey);
      if (processedValue === true || processedValue === "true") {
        return;
      }
      const typeRaw = this.getFrontmatterValue(front, "Type") || "";
      const type = ("" + typeRaw).toLowerCase();
      const accepted = this.settings.triggerTypes.map((t) => t.toLowerCase());
      if (!accepted.includes(type)) {
        return;
      }
      const content = await this.app.vault.read(file);
      const extraction = await this.extractTaskFromContent(content, file.path);
      if (extraction && extraction.found) {
        await this.handleTaskExtraction(extraction, file);
      }
      await this.markFileProcessed(file);
      if (this.processingQueue.has(file.path)) {
        this.processingQueue.get(file.path).status = "completed";
      }
    } catch (err) {
      console.error("TaskExtractor error", err);
      new import_obsidian2.Notice("Task Extractor: error processing file \u2014 see console");
      if (this.processingQueue.has(file.path)) {
        this.processingQueue.get(file.path).status = "failed";
      }
    } finally {
      this.cleanupFileProcessing(file.path);
    }
  }
  // Centralized cleanup method for atomic processing
  cleanupFileProcessing(filePath) {
    const status = this.processingQueue.get(filePath);
    if (status == null ? void 0 : status.timeout) {
      clearTimeout(status.timeout);
    }
    this.processingQueue.delete(filePath);
    this.processingFiles.delete(filePath);
  }
  // scan vault once on load for unprocessed matching notes
  async scanExistingFiles() {
    const files = this.getUnprocessedFiles();
    const batches = this.chunkArray(files, 5);
    for (const batch of batches) {
      await Promise.all(batch.map((f) => this.onFileChanged(f)));
      await this.delay(100);
    }
  }
  // Get list of unprocessed files that match trigger criteria
  getUnprocessedFiles() {
    const files = this.app.vault.getMarkdownFiles();
    const unprocessedFiles = [];
    for (const f of files) {
      const cache = this.app.metadataCache.getFileCache(f);
      const front = cache == null ? void 0 : cache.frontmatter;
      if (!front)
        continue;
      const typeRaw = this.getFrontmatterValue(front, "Type") || "";
      const type = ("" + typeRaw).toLowerCase();
      const accepted = this.settings.triggerTypes.map((t) => t.toLowerCase());
      const processedValue = this.getFrontmatterValue(front, this.settings.processedFrontmatterKey);
      if (accepted.includes(type) && !(processedValue === true || processedValue === "true")) {
        unprocessedFiles.push(f);
      }
    }
    return unprocessedFiles;
  }
  // Utility function to chunk array into smaller batches
  chunkArray(array, size) {
    const chunks = [];
    for (let i = 0; i < array.length; i += size) {
      chunks.push(array.slice(i, i + size));
    }
    return chunks;
  }
  // Utility function for delays
  delay(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
  }
  getFrontmatterValue(front, key) {
    if (!front)
      return void 0;
    if (key.includes(".")) {
      const parts = key.split(".");
      let cur = front;
      for (const p of parts) {
        if (!cur)
          return void 0;
        cur = cur[p];
      }
      return cur;
    }
    return front[key];
  }
  async markFileProcessed(file) {
    if (!this.settings.processedFrontmatterKey)
      return;
    try {
      await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
        const keys = this.settings.processedFrontmatterKey.split(".");
        let current = frontmatter;
        for (let i = 0; i < keys.length - 1; i++) {
          const key = keys[i];
          if (!current[key] || typeof current[key] !== "object") {
            current[key] = {};
          }
          current = current[key];
        }
        current[keys[keys.length - 1]] = true;
      });
    } catch (e) {
      console.warn("Failed to mark file processed with official API:", e);
      await this.markFileProcessedFallback(file);
    }
  }
  // Fallback method using the previous implementation
  async markFileProcessedFallback(file) {
    try {
      const content = await this.app.vault.read(file);
      const fmMatch = content.match(/^---\n([\s\S]*?)\n---/);
      let newContent = content;
      if (fmMatch) {
        const fm = fmMatch[1];
        const processedKey = this.settings.processedFrontmatterKey;
        if (!new RegExp("^" + processedKey.replace(".", "\\.") + ":", "m").test(fm)) {
          const lines = fm.split("\n");
          lines.push(`${processedKey}: true`);
          const updatedFm = lines.join("\n");
          newContent = content.replace(fmMatch[0], `---
${updatedFm}
---`);
          await this.app.vault.modify(file, newContent);
        }
      } else {
        const processedKey = this.settings.processedFrontmatterKey;
        newContent = `---
${processedKey}: true
---

` + content;
        await this.app.vault.modify(file, newContent);
      }
    } catch (e) {
      console.warn("Failed to mark file processed with fallback method:", e);
    }
  }
  // Shared method for constructing prompts
  buildExtractionPrompt(sourcePath, content) {
    const basePrompt = this.settings.customPrompt || `You are a task extraction specialist. Extract actionable tasks from emails and meeting notes following these strict rules:

EXTRACTION RULES:
- Extract ONLY concrete, actionable tasks explicitly stated or clearly implied
- Use null for uncertain/missing information - DO NOT GUESS
- Extract tasks only for the specified person: ${this.settings.ownerName} (exact name)
- If no clear tasks exist, return {"found": false, "tasks": []}

PRIORITY GUIDELINES:
- high: explicit urgency/deadline mentioned
- medium: standard requests without time pressure  
- low: optional/background items

VALIDATION CONSTRAINTS:
- task_title: 6-100 characters, actionable phrasing
- task_details: max 300 characters, concrete description
- due_date: YYYY-MM-DD format only if explicitly mentioned
- source_excerpt: exact quote (max 150 chars) justifying extraction

Return valid JSON only. Be conservative - accuracy over completeness.`;
    const fieldDescriptions = this.settings.frontmatterFields.filter((f) => f.required || f.key === "task_title" || f.key === "task_details").map((f) => {
      var _a;
      if (f.key === "task" || f.key === "task_title")
        return "- task_title: short (6-100 words) actionable title";
      if (f.key === "task_details")
        return "- task_details: 1-3 sentences describing what to do and any context";
      if (f.key === "due")
        return "- due_date: ISO date YYYY-MM-DD if explicitly present in the text, otherwise null";
      if (f.key === "priority")
        return `- priority: ${((_a = f.options) == null ? void 0 : _a.join("|")) || "high|medium|low"} (choose best match)`;
      if (f.key === "project")
        return "- project: project name if mentioned, otherwise null";
      if (f.key === "client")
        return "- client: client name if mentioned, otherwise null";
      return `- ${f.key}: ${f.defaultValue || "appropriate value based on context"}`;
    });
    const system = `${basePrompt}

When tasks are found, return JSON in this format:
{
  "found": true,
  "tasks": [
    {
      ${fieldDescriptions.join(",\n      ")},
      "source_excerpt": "exact quote from source (max 150 chars)",
      "confidence": "high|medium|low"
    }
  ],
  "confidence": "high|medium|low"
}

When no tasks found, return: {"found": false, "tasks": []}`;
    const user = `SOURCE_PATH: ${sourcePath}
---BEGIN NOTE---
${content}
---END NOTE---`;
    return { system, user };
  }
  // New method for multi-task extraction
  async extractMultipleTasksFromContent(content, sourcePath) {
    const { system, user } = this.buildExtractionPrompt(sourcePath, content);
    try {
      const raw = await this.llmProvider.callLLM(system, user);
      const parsed = this.safeParseJSON(raw);
      if (!parsed)
        return { found: false, tasks: [] };
      if ("tasks" in parsed && Array.isArray(parsed.tasks)) {
        return parsed;
      }
      if ("found" in parsed && parsed.found) {
        return {
          found: true,
          tasks: [{
            task_title: parsed.task_title || "Unspecified task",
            task_details: parsed.task_details || "",
            due_date: parsed.due_date || null,
            priority: parsed.priority || "medium",
            project: parsed.project || null,
            client: parsed.client || null,
            source_excerpt: parsed.source_excerpt || "",
            confidence: parsed.confidence || "medium"
          }]
        };
      }
      return { found: false, tasks: [] };
    } catch (e) {
      console.error("extractMultipleTasksFromContent error", e);
      return { found: false, tasks: [] };
    }
  }
  // Handle task extraction results (both single and multi-task)
  async handleTaskExtraction(extraction, sourceFile) {
    try {
      if ("tasks" in extraction && Array.isArray(extraction.tasks)) {
        let createdCount = 0;
        for (const task of extraction.tasks) {
          try {
            await this.createTaskNote(task, sourceFile);
            createdCount++;
          } catch (error) {
            console.error(`Failed to create task note for: ${task.task_title}`, error);
          }
        }
        if (createdCount > 0) {
          new import_obsidian2.Notice(`Task Extractor: created ${createdCount} task note${createdCount !== 1 ? "s" : ""}`);
        }
      } else {
        await this.createTaskNote(extraction, sourceFile);
        new import_obsidian2.Notice(`Task Extractor: created task "${extraction.task_title}"`);
      }
    } catch (error) {
      console.error("Error handling task extraction:", error);
      new import_obsidian2.Notice("Task Extractor: error creating task notes \u2014 see console");
    }
  }
  // Compose prompt, call LLM, and parse response (legacy method for backward compatibility)
  async extractTaskFromContent(content, sourcePath) {
    const { system, user } = this.buildExtractionPrompt(sourcePath, content);
    try {
      const raw = await this.llmProvider.callLLM(system, user);
      const parsed = this.safeParseJSON(raw);
      if (!parsed)
        return { found: false };
      if (parsed.tasks && Array.isArray(parsed.tasks)) {
        if (parsed.tasks.length > 0) {
          const firstTask = parsed.tasks[0];
          return {
            found: true,
            task_title: firstTask.task_title || "Unspecified task",
            task_details: firstTask.task_details || "",
            due_date: firstTask.due_date || null,
            priority: firstTask.priority || "medium",
            source_excerpt: firstTask.source_excerpt || "",
            confidence: firstTask.confidence,
            ...firstTask
            // Include any additional extracted fields
          };
        } else {
          return { found: false };
        }
      }
      if (!parsed.found)
        return { found: false };
      return {
        found: true,
        task_title: parsed.task_title || parsed.title || "Unspecified task",
        task_details: parsed.task_details || parsed.details || "",
        due_date: parsed.due_date || null,
        priority: parsed.priority || "medium",
        source_excerpt: parsed.source_excerpt || "",
        ...parsed
        // Include any additional extracted fields
      };
    } catch (e) {
      console.error("extractTaskFromContent error", e);
      return { found: false };
    }
  }
  safeParseJSON(text) {
    if (!text)
      return null;
    let parsed = null;
    try {
      parsed = JSON.parse(text);
    } catch (e) {
      const m = text.match(/\{[\s\S]*\}/);
      if (m) {
        try {
          parsed = JSON.parse(m[0]);
        } catch (e2) {
          const fixed = m[0].replace(/'/g, '"');
          try {
            parsed = JSON.parse(fixed);
          } catch (e3) {
            return null;
          }
        }
      } else {
        return null;
      }
    }
    if (!parsed || typeof parsed !== "object")
      return null;
    return this.validateAndNormalizeParsedResult(parsed);
  }
  validateAndNormalizeParsedResult(data) {
    if (typeof data !== "object" || data === null)
      return null;
    if (data.hasOwnProperty("tasks") && Array.isArray(data.tasks)) {
      const validTasks = [];
      for (const task of data.tasks) {
        if (this.isValidTask(task)) {
          validTasks.push({
            task_title: task.task_title || "Unspecified task",
            task_details: task.task_details || "",
            due_date: task.due_date || null,
            priority: task.priority || "medium",
            project: task.project || null,
            client: task.client || null,
            source_excerpt: task.source_excerpt || "",
            confidence: task.confidence || "medium",
            ...task
          });
        }
      }
      return {
        found: data.found === true && validTasks.length > 0,
        tasks: validTasks,
        confidence: data.confidence || "medium"
      };
    }
    if (data.hasOwnProperty("found")) {
      return {
        found: data.found === true,
        task_title: data.task_title || data.title || "",
        task_details: data.task_details || data.details || "",
        due_date: data.due_date || null,
        priority: data.priority || "medium",
        source_excerpt: data.source_excerpt || "",
        ...data
      };
    }
    return null;
  }
  isValidTask(task) {
    if (typeof task !== "object" || !task)
      return false;
    if (!task.task_title || typeof task.task_title !== "string" || task.task_title.trim().length === 0) {
      return false;
    }
    if (task.confidence && !["high", "medium", "low"].includes(task.confidence)) {
      return false;
    }
    if (task.priority && !["high", "medium", "low"].includes(task.priority)) {
      return false;
    }
    if (task.due_date && typeof task.due_date === "string") {
      const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
      if (!dateRegex.test(task.due_date)) {
        return false;
      }
    }
    return true;
  }
  // Create TaskNotesâ€“compatible note in tasksFolder
  async createTaskNote(extraction, sourceFile) {
    const safeTitle = this.makeFilenameSafe(extraction.task_title || "task");
    let filename = `${safeTitle}.md`;
    let folder = this.settings.tasksFolder.trim() || "Tasks";
    let path = `${folder}/${filename}`;
    let counter = 1;
    while (this.app.vault.getAbstractFileByPath(path)) {
      path = `${folder}/${safeTitle}-${counter}.md`;
      counter++;
    }
    const lines = [];
    lines.push("---");
    for (const field of this.settings.frontmatterFields) {
      let value = extraction[field.key] || extraction[field.key.replace("_", "")] || field.defaultValue;
      if (value === "{{date}}") {
        value = new Date().toISOString().split("T")[0];
      }
      if (field.key === "task" && !value && extraction.task_title) {
        value = extraction.task_title;
      }
      if (value) {
        if (field.type === "text" && typeof value === "string" && value.includes(" ")) {
          lines.push(`${field.key}: "${value}"`);
        } else {
          lines.push(`${field.key}: ${value}`);
        }
      }
    }
    lines.push("---");
    lines.push("");
    lines.push(extraction.task_details || "");
    lines.push("");
    if (this.settings.linkBack) {
      const link = `[[${sourceFile.path}]]`;
      lines.push(`Source: ${link}`);
    }
    if (extraction.source_excerpt) {
      lines.push("");
      lines.push("> Justification excerpt:");
      lines.push("> " + extraction.source_excerpt.replace(/\n/g, " "));
    }
    const final = lines.join("\n");
    try {
      await this.app.vault.create(path, final);
      new import_obsidian2.Notice(`Task Extractor: created task "${extraction.task_title}"`);
    } catch (e) {
      console.error("Failed to create task note", e);
      new import_obsidian2.Notice("Task Extractor: failed to create task note \u2014 see console");
    }
  }
  makeFilenameSafe(title) {
    return title.replace(/[\\/:*?"<>|#%{}\\^~\[\]`;'@&=+]/g, "").replace(/\s+/g, "-").slice(0, 120);
  }
  // Enhanced cleanup method with processing queue management
  cleanup() {
    this.fileChangeDebouncer.forEach((timeout) => clearTimeout(timeout));
    this.fileChangeDebouncer.clear();
    this.processingQueue.forEach((status) => {
      if (status.timeout) {
        clearTimeout(status.timeout);
      }
    });
    this.processingQueue.clear();
    this.processingFiles.clear();
  }
  // Methods for backward compatibility
  getProcessingFiles() {
    return this.processingFiles;
  }
};

// main.ts
var TaskExtractorPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.processingFiles = /* @__PURE__ */ new Set();
    this.serviceCache = /* @__PURE__ */ new Map();
    this.serviceCheckInterval = null;
    this.cloudModelCache = /* @__PURE__ */ new Map();
    this.apiKeyMissingNotified = /* @__PURE__ */ new Set();
    this.fileChangeDebouncer = /* @__PURE__ */ new Map();
  }
  async onload() {
    console.log("Loading Task Extractor plugin...");
    await this.loadSettings();
    this.llmProvider = new LLMProviderManager(this.settings);
    this.taskProcessor = new TaskProcessor(this.app, this.settings, this.llmProvider);
    this.serviceCache = this.llmProvider.getServiceCache();
    this.cloudModelCache = this.llmProvider.getCloudModelCache();
    this.apiKeyMissingNotified = this.llmProvider.getApiKeyMissingNotified();
    this.processingFiles = this.taskProcessor.getProcessingFiles();
    this.addSettingTab(new ExtractorSettingTab(this.app, this));
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian3.TFile) {
          this.debounceFileChange(file);
        }
      })
    );
    if (this.settings.processOnUpdate) {
      this.registerEvent(
        this.app.vault.on("modify", (file) => {
          if (file instanceof import_obsidian3.TFile) {
            this.debounceFileChange(file);
          }
        })
      );
    }
    await this.initializeServices();
    this.scanExistingFiles();
  }
  onunload() {
    console.log("Unloading Task Extractor plugin...");
    if (this.serviceCheckInterval) {
      clearInterval(this.serviceCheckInterval);
      this.serviceCheckInterval = null;
    }
    this.fileChangeDebouncer.forEach((timeout) => clearTimeout(timeout));
    this.fileChangeDebouncer.clear();
    this.cloudModelCache.clear();
    this.apiKeyMissingNotified.clear();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // Debounce file changes to prevent rapid processing
  debounceFileChange(file) {
    const existing = this.fileChangeDebouncer.get(file.path);
    if (existing) {
      clearTimeout(existing);
    }
    this.fileChangeDebouncer.set(file.path, setTimeout(() => {
      this.onFileChanged(file);
      this.fileChangeDebouncer.delete(file.path);
    }, 2e3));
  }
  // Delegate to task processor
  async onFileChanged(file) {
    return this.taskProcessor.onFileChanged(file);
  }
  async scanExistingFiles() {
    return this.taskProcessor.scanExistingFiles();
  }
  // Service Detection and Management - delegate to LLM provider
  async initializeServices() {
  }
  async detectServices() {
    return this.llmProvider.detectServices();
  }
  getAvailableServices() {
    return this.llmProvider.getAvailableServices();
  }
  // LLM calls - delegate to provider
  async callLLM(systemPrompt, userPrompt) {
    return this.llmProvider.callLLM(systemPrompt, userPrompt);
  }
  async fetchCloudModels(provider) {
    return this.llmProvider.fetchCloudModels(provider);
  }
  getDefaultModels(provider) {
    return this.llmProvider.getDefaultModels(provider);
  }
};
var ExtractorSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.saveTimeout = null;
    this.plugin = plugin;
  }
  // Debounced save to reduce save frequency
  debouncedSave() {
    if (this.saveTimeout) {
      clearTimeout(this.saveTimeout);
    }
    this.saveTimeout = setTimeout(async () => {
      await this.plugin.saveSettings();
      this.saveTimeout = null;
    }, 500);
  }
  // Clean up timeout on hide
  hide() {
    if (this.saveTimeout) {
      clearTimeout(this.saveTimeout);
      this.saveTimeout = null;
    }
    super.hide();
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Task Extractor Settings" });
    this.addProviderSection(containerEl);
    this.addLocalLLMSection(containerEl);
    this.addProcessingSection(containerEl);
    this.addFrontmatterSection(containerEl);
    this.addAdvancedSection(containerEl);
  }
  addProviderSection(containerEl) {
    containerEl.createEl("h3", { text: "LLM Provider Configuration" });
    const statusEl = containerEl.createEl("div", { cls: "task-extractor-status" });
    this.updateServiceStatus(statusEl);
    new import_obsidian3.Setting(containerEl).setName("Provider").setDesc("Choose LLM provider. Local providers (Ollama/LM Studio) require the service to be running.").addDropdown((cb) => cb.addOption("openai", "OpenAI").addOption("anthropic", "Anthropic").addOption("ollama", "Ollama (Local)").addOption("lmstudio", "LM Studio (Local)").setValue(this.plugin.settings.provider).onChange((v) => {
      this.plugin.settings.provider = v;
      this.debouncedSave();
      this.plugin.apiKeyMissingNotified.clear();
      this.updateServiceStatus(statusEl);
      this.display();
    }));
    if (["openai", "anthropic"].includes(this.plugin.settings.provider)) {
      new import_obsidian3.Setting(containerEl).setName("API Key").setDesc("Your API key for the selected provider. Models will be loaded automatically once entered.").addText((text) => text.setPlaceholder("sk-... or claude-...").setValue(this.plugin.settings.apiKey).onChange((v) => {
        this.plugin.settings.apiKey = v.trim();
        this.debouncedSave();
        const oldCacheKeys = Array.from(this.plugin.cloudModelCache.keys()).filter((key) => key.startsWith(this.plugin.settings.provider));
        oldCacheKeys.forEach((key) => this.plugin.cloudModelCache.delete(key));
        this.plugin.apiKeyMissingNotified.clear();
        this.display();
      }));
    }
    this.addModelSetting(containerEl);
  }
  async addModelSetting(containerEl) {
    const modelContainer = containerEl.createDiv();
    const provider = this.plugin.settings.provider;
    const service = this.plugin.serviceCache.get(provider);
    if (["ollama", "lmstudio"].includes(provider) && (service == null ? void 0 : service.available) && service.models.length > 0) {
      new import_obsidian3.Setting(modelContainer).setName("Model").setDesc(`Select from ${service.models.length} available ${provider} models.`).addDropdown((cb) => {
        service.models.forEach((model) => cb.addOption(model, model));
        cb.setValue(this.plugin.settings.model || service.models[0]).onChange((v) => {
          this.plugin.settings.model = v;
          this.debouncedSave();
        });
      });
    } else if (["openai", "anthropic"].includes(provider) && this.plugin.settings.apiKey) {
      const loadingSetting = new import_obsidian3.Setting(modelContainer).setName("Model").setDesc("Loading available models...");
      try {
        const availableModels = await this.plugin.fetchCloudModels(provider);
        modelContainer.empty();
        new import_obsidian3.Setting(modelContainer).setName("Model").setDesc(`Select from ${availableModels.length} available ${provider} models.`).addDropdown((cb) => {
          availableModels.forEach((model) => cb.addOption(model, model));
          const currentModel = this.plugin.settings.model;
          const defaultModel = availableModels.includes(currentModel) ? currentModel : availableModels[0];
          cb.setValue(defaultModel).onChange((v) => {
            this.plugin.settings.model = v;
            this.debouncedSave();
          });
        });
        new import_obsidian3.Setting(modelContainer).setName("Refresh Models").setDesc("Reload the list of available models from the API.").addButton((button) => button.setButtonText("Refresh").onClick(async () => {
          this.plugin.cloudModelCache.clear();
          this.display();
        }));
      } catch (error) {
        modelContainer.empty();
        this.addFallbackModelSetting(modelContainer, provider);
      }
    } else {
      this.addFallbackModelSetting(modelContainer, provider);
    }
  }
  addFallbackModelSetting(container, provider) {
    const defaultModels = {
      openai: "gpt-4o-mini",
      anthropic: "claude-3-haiku-20240307",
      ollama: "llama3.2",
      lmstudio: "local-model"
    };
    const description = ["ollama", "lmstudio"].includes(provider) ? `Enter model name. Service not detected or no models available.` : `Enter model name manually.`;
    new import_obsidian3.Setting(container).setName("Model").setDesc(description).addText((text) => text.setPlaceholder(defaultModels[provider] || "").setValue(this.plugin.settings.model).onChange((v) => {
      this.plugin.settings.model = v.trim();
      this.debouncedSave();
    }));
  }
  addLocalLLMSection(containerEl) {
    containerEl.createEl("h3", { text: "Local LLM Configuration" });
    if (this.plugin.settings.provider === "ollama") {
      new import_obsidian3.Setting(containerEl).setName("Ollama URL").setDesc("URL for your Ollama instance.").addText((text) => text.setValue(this.plugin.settings.ollamaUrl).onChange((v) => {
        this.plugin.settings.ollamaUrl = v.trim();
        this.debouncedSave();
      }));
    }
    if (this.plugin.settings.provider === "lmstudio") {
      new import_obsidian3.Setting(containerEl).setName("LM Studio URL").setDesc("URL for your LM Studio instance.").addText((text) => text.setValue(this.plugin.settings.lmstudioUrl).onChange((v) => {
        this.plugin.settings.lmstudioUrl = v.trim();
        this.debouncedSave();
      }));
    }
    new import_obsidian3.Setting(containerEl).setName("Model Refresh Interval").setDesc("How often to check for available models (minutes).").addSlider((slider) => slider.setLimits(1, 60, 1).setValue(this.plugin.settings.localModelRefreshInterval).setDynamicTooltip().onChange((v) => {
      this.plugin.settings.localModelRefreshInterval = v;
      this.debouncedSave();
    }));
  }
  addProcessingSection(containerEl) {
    containerEl.createEl("h3", { text: "Processing Settings" });
    new import_obsidian3.Setting(containerEl).setName("Owner name").setDesc("Exact name the LLM should look for when deciding tasks.").addText((text) => text.setPlaceholder("Bryan Kolb").setValue(this.plugin.settings.ownerName).onChange((v) => {
      this.plugin.settings.ownerName = v.trim();
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Tasks folder").setDesc("Folder where generated task notes will be created.").addText((text) => text.setValue(this.plugin.settings.tasksFolder).onChange((v) => {
      this.plugin.settings.tasksFolder = v.trim();
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Trigger note types").setDesc("Comma-separated list of note types to process (from frontmatter Type field).").addText((text) => text.setValue(this.plugin.settings.triggerTypes.join(", ")).onChange((v) => {
      this.plugin.settings.triggerTypes = v.split(",").map((s) => s.trim()).filter((s) => s.length > 0);
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Process edits as well as new files").setDesc("If enabled, modifications to matching notes will be processed too.").addToggle((toggle) => toggle.setValue(this.plugin.settings.processOnUpdate).onChange((v) => {
      this.plugin.settings.processOnUpdate = v;
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Link back to source").setDesc("Insert a link back to the source note in generated task notes.").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkBack).onChange((v) => {
      this.plugin.settings.linkBack = v;
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Processed marker key").setDesc("Frontmatter key to mark processed notes.").addText((text) => text.setValue(this.plugin.settings.processedFrontmatterKey).onChange((v) => {
      this.plugin.settings.processedFrontmatterKey = v.trim();
      this.debouncedSave();
    }));
  }
  addFrontmatterSection(containerEl) {
    containerEl.createEl("h3", { text: "Task Note Frontmatter" });
    new import_obsidian3.Setting(containerEl).setName("Add Field").setDesc("Add a new frontmatter field").addButton((button) => button.setButtonText("Add Field").onClick(() => {
      this.plugin.settings.frontmatterFields.push({
        key: "new_field",
        defaultValue: "",
        type: "text",
        required: false
      });
      this.debouncedSave();
      this.display();
    }));
    this.plugin.settings.frontmatterFields.forEach((field, index) => {
      const fieldContainer = containerEl.createDiv({ cls: "task-extractor-field" });
      new import_obsidian3.Setting(fieldContainer).setName(`Field ${index + 1}: ${field.key}`).setDesc(`Type: ${field.type}, Required: ${field.required ? "Yes" : "No"}`).addButton((button) => button.setButtonText("Remove").onClick(() => {
        this.plugin.settings.frontmatterFields.splice(index, 1);
        this.debouncedSave();
        this.display();
      }));
    });
    new import_obsidian3.Setting(containerEl).setName("Custom Prompt").setDesc("Override the default task extraction prompt. Leave empty to use default.").addTextArea((text) => text.setPlaceholder("Enter custom prompt...").setValue(this.plugin.settings.customPrompt).onChange((v) => {
      this.plugin.settings.customPrompt = v;
      this.debouncedSave();
    }));
  }
  addAdvancedSection(containerEl) {
    containerEl.createEl("h3", { text: "Advanced Settings" });
    new import_obsidian3.Setting(containerEl).setName("Max Tokens").setDesc("Maximum tokens to generate.").addSlider((slider) => slider.setLimits(100, 2e3, 50).setValue(this.plugin.settings.maxTokens).setDynamicTooltip().onChange((v) => {
      this.plugin.settings.maxTokens = v;
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Temperature").setDesc("Creativity level (0 = deterministic, 1 = creative).").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.temperature).setDynamicTooltip().onChange((v) => {
      this.plugin.settings.temperature = v;
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Timeout (seconds)").setDesc("Request timeout for LLM calls.").addSlider((slider) => slider.setLimits(10, 120, 5).setValue(this.plugin.settings.timeout).setDynamicTooltip().onChange((v) => {
      this.plugin.settings.timeout = v;
      this.debouncedSave();
    }));
    new import_obsidian3.Setting(containerEl).setName("Retry Attempts").setDesc("Number of retry attempts for failed requests.").addSlider((slider) => slider.setLimits(1, 5, 1).setValue(this.plugin.settings.retries).setDynamicTooltip().onChange((v) => {
      this.plugin.settings.retries = v;
      this.debouncedSave();
    }));
  }
  updateServiceStatus(statusEl) {
    statusEl.empty();
    const provider = this.plugin.settings.provider;
    const service = this.plugin.serviceCache.get(provider);
    if (["ollama", "lmstudio"].includes(provider)) {
      if (service == null ? void 0 : service.available) {
        statusEl.createEl("div", {
          text: `\u2705 ${provider} connected (${service.models.length} models)`,
          cls: "task-extractor-status-success"
        });
      } else {
        statusEl.createEl("div", {
          text: `\u274C ${provider} not available`,
          cls: "task-extractor-status-error"
        });
      }
    } else {
      if (this.plugin.settings.apiKey) {
        statusEl.createEl("div", {
          text: `\u2705 ${provider} API key configured`,
          cls: "task-extractor-status-success"
        });
      } else {
        statusEl.createEl("div", {
          text: `\u274C ${provider} API key required`,
          cls: "task-extractor-status-error"
        });
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdHlwZXMudHMiLCAic3JjL2xsbS1wcm92aWRlcnMudHMiLCAic3JjL3Rhc2stcHJvY2Vzc29yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKlxyXG5PYnNpZGlhbiBQbHVnaW46IFRhc2sgRXh0cmFjdG9yIGZvciBFbWFpbHMgJiBNZWV0aW5nIE5vdGVzXHJcbkVuaGFuY2VkIHZlcnNpb24gd2l0aCBsb2NhbCBMTE0gc3VwcG9ydCBhbmQgY3VzdG9taXphYmxlIGZyb250bWF0dGVyXHJcblxyXG5GZWF0dXJlczpcclxuLSBNdWx0aS1wcm92aWRlciBMTE0gc3VwcG9ydDogT3BlbkFJLCBBbnRocm9waWMsIE9sbGFtYSwgTE0gU3R1ZGlvXHJcbi0gQXV0by1kZXRlY3Rpb24gb2YgbG9jYWwgTExNIHNlcnZpY2VzXHJcbi0gQ3VzdG9taXphYmxlIGZyb250bWF0dGVyIHRlbXBsYXRlcyBmb3IgdGFzayBjcmVhdGlvblxyXG4tIEFkdmFuY2VkIHNldHRpbmdzIHdpdGggcmVhbC10aW1lIHNlcnZpY2UgbW9uaXRvcmluZ1xyXG4tIFJvYnVzdCBlcnJvciBoYW5kbGluZyBhbmQgZmFsbGJhY2sgc3RyYXRlZ2llc1xyXG4qL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFeHRyYWN0b3JTZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUywgRnJvbnRtYXR0ZXJGaWVsZCwgTExNU2VydmljZSB9IGZyb20gJy4vc3JjL3R5cGVzJztcclxuaW1wb3J0IHsgTExNUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvbGxtLXByb3ZpZGVycyc7XHJcbmltcG9ydCB7IFRhc2tQcm9jZXNzb3IgfSBmcm9tICcuL3NyYy90YXNrLXByb2Nlc3Nvcic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYXNrRXh0cmFjdG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzZXR0aW5nczogRXh0cmFjdG9yU2V0dGluZ3M7XHJcbiAgcHJvY2Vzc2luZ0ZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICBzZXJ2aWNlQ2FjaGU6IE1hcDxzdHJpbmcsIExMTVNlcnZpY2U+ID0gbmV3IE1hcCgpO1xyXG4gIHNlcnZpY2VDaGVja0ludGVydmFsOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xyXG4gIGNsb3VkTW9kZWxDYWNoZTogTWFwPHN0cmluZywgc3RyaW5nW10+ID0gbmV3IE1hcCgpO1xyXG4gIGFwaUtleU1pc3NpbmdOb3RpZmllZDogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XHJcbiAgZmlsZUNoYW5nZURlYm91bmNlcjogTWFwPHN0cmluZywgTm9kZUpTLlRpbWVvdXQ+ID0gbmV3IE1hcCgpO1xyXG5cclxuICBwcml2YXRlIGxsbVByb3ZpZGVyOiBMTE1Qcm92aWRlck1hbmFnZXI7XHJcbiAgcHJpdmF0ZSB0YXNrUHJvY2Vzc29yOiBUYXNrUHJvY2Vzc29yO1xyXG5cclxuICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnTG9hZGluZyBUYXNrIEV4dHJhY3RvciBwbHVnaW4uLi4nKTtcclxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBtb2R1bGFyIGNvbXBvbmVudHNcclxuICAgIHRoaXMubGxtUHJvdmlkZXIgPSBuZXcgTExNUHJvdmlkZXJNYW5hZ2VyKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgdGhpcy50YXNrUHJvY2Vzc29yID0gbmV3IFRhc2tQcm9jZXNzb3IodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIHRoaXMubGxtUHJvdmlkZXIpO1xyXG5cclxuICAgIC8vIFN5bmMgdGhlIHJlZmVyZW5jZXMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgIHRoaXMuc2VydmljZUNhY2hlID0gdGhpcy5sbG1Qcm92aWRlci5nZXRTZXJ2aWNlQ2FjaGUoKTtcclxuICAgIHRoaXMuY2xvdWRNb2RlbENhY2hlID0gdGhpcy5sbG1Qcm92aWRlci5nZXRDbG91ZE1vZGVsQ2FjaGUoKTtcclxuICAgIHRoaXMuYXBpS2V5TWlzc2luZ05vdGlmaWVkID0gdGhpcy5sbG1Qcm92aWRlci5nZXRBcGlLZXlNaXNzaW5nTm90aWZpZWQoKTtcclxuICAgIHRoaXMucHJvY2Vzc2luZ0ZpbGVzID0gdGhpcy50YXNrUHJvY2Vzc29yLmdldFByb2Nlc3NpbmdGaWxlcygpO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIHNldHRpbmdzIHRhYlxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBFeHRyYWN0b3JTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG4gICAgLy8gSG9vayBpbnRvIG1ldGFkYXRhIGNoYW5nZXMgKGZpbGUgY3JlYXRlZC91cGRhdGVkKVxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgKGZpbGUpID0+IHtcclxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICB0aGlzLmRlYm91bmNlRmlsZUNoYW5nZShmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIGlmICh0aGlzLnNldHRpbmdzLnByb2Nlc3NPblVwZGF0ZSkge1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ21vZGlmeScsIChmaWxlKSA9PiB7XHJcbiAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVib3VuY2VGaWxlQ2hhbmdlKGZpbGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlIGRldGVjdGlvblxyXG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplU2VydmljZXMoKTtcclxuICAgIFxyXG4gICAgLy8gQWxzbyBzY2FuIGV4aXN0aW5nIHVucHJvY2Vzc2VkIGZpbGVzIG9uY2Ugb24gbG9hZCAobm9uLWJsb2NraW5nKVxyXG4gICAgdGhpcy5zY2FuRXhpc3RpbmdGaWxlcygpO1xyXG4gIH1cclxuXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnVW5sb2FkaW5nIFRhc2sgRXh0cmFjdG9yIHBsdWdpbi4uLicpO1xyXG4gICAgaWYgKHRoaXMuc2VydmljZUNoZWNrSW50ZXJ2YWwpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNlcnZpY2VDaGVja0ludGVydmFsKTtcclxuICAgICAgdGhpcy5zZXJ2aWNlQ2hlY2tJbnRlcnZhbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICAvLyBDbGVhciBwZW5kaW5nIGZpbGUgY2hhbmdlIHRpbWVvdXRzXHJcbiAgICB0aGlzLmZpbGVDaGFuZ2VEZWJvdW5jZXIuZm9yRWFjaCh0aW1lb3V0ID0+IGNsZWFyVGltZW91dCh0aW1lb3V0KSk7XHJcbiAgICB0aGlzLmZpbGVDaGFuZ2VEZWJvdW5jZXIuY2xlYXIoKTtcclxuICAgIC8vIENsZWFyIGNhY2hlc1xyXG4gICAgdGhpcy5jbG91ZE1vZGVsQ2FjaGUuY2xlYXIoKTtcclxuICAgIHRoaXMuYXBpS2V5TWlzc2luZ05vdGlmaWVkLmNsZWFyKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgfVxyXG5cclxuICAvLyBEZWJvdW5jZSBmaWxlIGNoYW5nZXMgdG8gcHJldmVudCByYXBpZCBwcm9jZXNzaW5nXHJcbiAgcHJpdmF0ZSBkZWJvdW5jZUZpbGVDaGFuZ2UoZmlsZTogVEZpbGUpIHtcclxuICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5maWxlQ2hhbmdlRGVib3VuY2VyLmdldChmaWxlLnBhdGgpO1xyXG4gICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgIGNsZWFyVGltZW91dChleGlzdGluZyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRoaXMuZmlsZUNoYW5nZURlYm91bmNlci5zZXQoZmlsZS5wYXRoLCBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5vbkZpbGVDaGFuZ2VkKGZpbGUpO1xyXG4gICAgICB0aGlzLmZpbGVDaGFuZ2VEZWJvdW5jZXIuZGVsZXRlKGZpbGUucGF0aCk7XHJcbiAgICB9LCAyMDAwKSk7XHJcbiAgfVxyXG5cclxuICAvLyBEZWxlZ2F0ZSB0byB0YXNrIHByb2Nlc3NvclxyXG4gIGFzeW5jIG9uRmlsZUNoYW5nZWQoZmlsZTogVEZpbGUpIHtcclxuICAgIHJldHVybiB0aGlzLnRhc2tQcm9jZXNzb3Iub25GaWxlQ2hhbmdlZChmaWxlKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNjYW5FeGlzdGluZ0ZpbGVzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMudGFza1Byb2Nlc3Nvci5zY2FuRXhpc3RpbmdGaWxlcygpO1xyXG4gIH1cclxuXHJcbiAgLy8gU2VydmljZSBEZXRlY3Rpb24gYW5kIE1hbmFnZW1lbnQgLSBkZWxlZ2F0ZSB0byBMTE0gcHJvdmlkZXJcclxuICBhc3luYyBpbml0aWFsaXplU2VydmljZXMoKSB7XHJcbiAgICAvLyBObyBsb25nZXIgZG8gdXBmcm9udCBkZXRlY3Rpb24gLSB1c2UgbGF6eSBsb2FkaW5nXHJcbiAgfVxyXG5cclxuICBhc3luYyBkZXRlY3RTZXJ2aWNlcygpOiBQcm9taXNlPE1hcDxzdHJpbmcsIExMTVNlcnZpY2U+PiB7XHJcbiAgICByZXR1cm4gdGhpcy5sbG1Qcm92aWRlci5kZXRlY3RTZXJ2aWNlcygpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXZhaWxhYmxlU2VydmljZXMoKTogTExNU2VydmljZVtdIHtcclxuICAgIHJldHVybiB0aGlzLmxsbVByb3ZpZGVyLmdldEF2YWlsYWJsZVNlcnZpY2VzKCk7XHJcbiAgfVxyXG5cclxuICAvLyBMTE0gY2FsbHMgLSBkZWxlZ2F0ZSB0byBwcm92aWRlclxyXG4gIGFzeW5jIGNhbGxMTE0oc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gICAgcmV0dXJuIHRoaXMubGxtUHJvdmlkZXIuY2FsbExMTShzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZmV0Y2hDbG91ZE1vZGVscyhwcm92aWRlcjogJ29wZW5haScgfCAnYW50aHJvcGljJyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIHJldHVybiB0aGlzLmxsbVByb3ZpZGVyLmZldGNoQ2xvdWRNb2RlbHMocHJvdmlkZXIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0RGVmYXVsdE1vZGVscyhwcm92aWRlcjogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIHRoaXMubGxtUHJvdmlkZXIuZ2V0RGVmYXVsdE1vZGVscyhwcm92aWRlcik7XHJcbiAgfVxyXG59XHJcblxyXG5jbGFzcyBFeHRyYWN0b3JTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBUYXNrRXh0cmFjdG9yUGx1Z2luO1xyXG4gIHByaXZhdGUgc2F2ZVRpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhc2tFeHRyYWN0b3JQbHVnaW4pIHtcclxuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLy8gRGVib3VuY2VkIHNhdmUgdG8gcmVkdWNlIHNhdmUgZnJlcXVlbmN5XHJcbiAgcHJpdmF0ZSBkZWJvdW5jZWRTYXZlKCkge1xyXG4gICAgaWYgKHRoaXMuc2F2ZVRpbWVvdXQpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2F2ZVRpbWVvdXQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLnNhdmVUaW1lb3V0ID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICB0aGlzLnNhdmVUaW1lb3V0ID0gbnVsbDtcclxuICAgIH0sIDUwMCk7XHJcbiAgfVxyXG5cclxuICAvLyBDbGVhbiB1cCB0aW1lb3V0IG9uIGhpZGVcclxuICBoaWRlKCkge1xyXG4gICAgaWYgKHRoaXMuc2F2ZVRpbWVvdXQpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2F2ZVRpbWVvdXQpO1xyXG4gICAgICB0aGlzLnNhdmVUaW1lb3V0ID0gbnVsbDtcclxuICAgIH1cclxuICAgIHN1cGVyLmhpZGUoKTtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdUYXNrIEV4dHJhY3RvciBTZXR0aW5ncycgfSk7XHJcblxyXG4gICAgLy8gUHJvdmlkZXIgU2VsZWN0aW9uXHJcbiAgICB0aGlzLmFkZFByb3ZpZGVyU2VjdGlvbihjb250YWluZXJFbCk7XHJcbiAgICBcclxuICAgIC8vIExvY2FsIExMTSBDb25maWd1cmF0aW9uXHJcbiAgICB0aGlzLmFkZExvY2FsTExNU2VjdGlvbihjb250YWluZXJFbCk7XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3NpbmcgU2V0dGluZ3NcclxuICAgIHRoaXMuYWRkUHJvY2Vzc2luZ1NlY3Rpb24oY29udGFpbmVyRWwpO1xyXG4gICAgXHJcbiAgICAvLyBGcm9udG1hdHRlciBDdXN0b21pemF0aW9uXHJcbiAgICB0aGlzLmFkZEZyb250bWF0dGVyU2VjdGlvbihjb250YWluZXJFbCk7XHJcbiAgICBcclxuICAgIC8vIEFkdmFuY2VkIFNldHRpbmdzXHJcbiAgICB0aGlzLmFkZEFkdmFuY2VkU2VjdGlvbihjb250YWluZXJFbCk7XHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgYWRkUHJvdmlkZXJTZWN0aW9uKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTExNIFByb3ZpZGVyIENvbmZpZ3VyYXRpb24nIH0pO1xyXG4gICAgXHJcbiAgICAvLyBTZXJ2aWNlIHN0YXR1cyBpbmRpY2F0b3JcclxuICAgIGNvbnN0IHN0YXR1c0VsID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAndGFzay1leHRyYWN0b3Itc3RhdHVzJyB9KTtcclxuICAgIHRoaXMudXBkYXRlU2VydmljZVN0YXR1cyhzdGF0dXNFbCk7XHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnUHJvdmlkZXInKVxyXG4gICAgICAuc2V0RGVzYygnQ2hvb3NlIExMTSBwcm92aWRlci4gTG9jYWwgcHJvdmlkZXJzIChPbGxhbWEvTE0gU3R1ZGlvKSByZXF1aXJlIHRoZSBzZXJ2aWNlIHRvIGJlIHJ1bm5pbmcuJylcclxuICAgICAgLmFkZERyb3Bkb3duKGNiID0+IGNiXHJcbiAgICAgICAgLmFkZE9wdGlvbignb3BlbmFpJywgJ09wZW5BSScpXHJcbiAgICAgICAgLmFkZE9wdGlvbignYW50aHJvcGljJywgJ0FudGhyb3BpYycpXHJcbiAgICAgICAgLmFkZE9wdGlvbignb2xsYW1hJywgJ09sbGFtYSAoTG9jYWwpJylcclxuICAgICAgICAuYWRkT3B0aW9uKCdsbXN0dWRpbycsICdMTSBTdHVkaW8gKExvY2FsKScpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyKVxyXG4gICAgICAgIC5vbkNoYW5nZSgodikgPT4geyBcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyID0gdiBhcyBhbnk7IFxyXG4gICAgICAgICAgdGhpcy5kZWJvdW5jZWRTYXZlKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIENsZWFyIEFQSSBrZXkgbm90aWZpY2F0aW9uIHdoZW4gc3dpdGNoaW5nIHByb3ZpZGVyc1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uYXBpS2V5TWlzc2luZ05vdGlmaWVkLmNsZWFyKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHRoaXMudXBkYXRlU2VydmljZVN0YXR1cyhzdGF0dXNFbCk7XHJcbiAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0byBzaG93L2hpZGUgcmVsZXZhbnQgc2V0dGluZ3NcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgLy8gQVBJIEtleSAob25seSBmb3IgY2xvdWQgcHJvdmlkZXJzKVxyXG4gICAgaWYgKFsnb3BlbmFpJywgJ2FudGhyb3BpYyddLmluY2x1ZGVzKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyKSkge1xyXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnQVBJIEtleScpXHJcbiAgICAgICAgLnNldERlc2MoJ1lvdXIgQVBJIGtleSBmb3IgdGhlIHNlbGVjdGVkIHByb3ZpZGVyLiBNb2RlbHMgd2lsbCBiZSBsb2FkZWQgYXV0b21hdGljYWxseSBvbmNlIGVudGVyZWQuJylcclxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignc2stLi4uIG9yIGNsYXVkZS0uLi4nKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUtleSlcclxuICAgICAgICAgIC5vbkNoYW5nZSgodikgPT4geyBcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpS2V5ID0gdi50cmltKCk7IFxyXG4gICAgICAgICAgICB0aGlzLmRlYm91bmNlZFNhdmUoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsZWFyIG1vZGVsIGNhY2hlIHdoZW4gQVBJIGtleSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGNvbnN0IG9sZENhY2hlS2V5cyA9IEFycmF5LmZyb20odGhpcy5wbHVnaW4uY2xvdWRNb2RlbENhY2hlLmtleXMoKSlcclxuICAgICAgICAgICAgICAuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcikpO1xyXG4gICAgICAgICAgICBvbGRDYWNoZUtleXMuZm9yRWFjaChrZXkgPT4gdGhpcy5wbHVnaW4uY2xvdWRNb2RlbENhY2hlLmRlbGV0ZShrZXkpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsZWFyIG5vdGlmaWNhdGlvbiBmbGFnXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwaUtleU1pc3NpbmdOb3RpZmllZC5jbGVhcigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUmVmcmVzaCBtb2RlbCBkcm9wZG93blxyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNb2RlbCBzZWxlY3Rpb24gKGFzeW5jKVxyXG4gICAgdGhpcy5hZGRNb2RlbFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG4gIH1cclxuICBcclxuICBwcml2YXRlIGFzeW5jIGFkZE1vZGVsU2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IG1vZGVsQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XHJcbiAgICBjb25zdCBwcm92aWRlciA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyO1xyXG4gICAgY29uc3Qgc2VydmljZSA9IHRoaXMucGx1Z2luLnNlcnZpY2VDYWNoZS5nZXQocHJvdmlkZXIpO1xyXG4gICAgXHJcbiAgICBpZiAoWydvbGxhbWEnLCAnbG1zdHVkaW8nXS5pbmNsdWRlcyhwcm92aWRlcikgJiYgc2VydmljZT8uYXZhaWxhYmxlICYmIHNlcnZpY2UubW9kZWxzLmxlbmd0aCA+IDApIHtcclxuICAgICAgLy8gU2hvdyBkcm9wZG93biBmb3IgYXZhaWxhYmxlIGxvY2FsIG1vZGVsc1xyXG4gICAgICBuZXcgU2V0dGluZyhtb2RlbENvbnRhaW5lcilcclxuICAgICAgICAuc2V0TmFtZSgnTW9kZWwnKVxyXG4gICAgICAgIC5zZXREZXNjKGBTZWxlY3QgZnJvbSAke3NlcnZpY2UubW9kZWxzLmxlbmd0aH0gYXZhaWxhYmxlICR7cHJvdmlkZXJ9IG1vZGVscy5gKVxyXG4gICAgICAgIC5hZGREcm9wZG93bihjYiA9PiB7XHJcbiAgICAgICAgICBzZXJ2aWNlLm1vZGVscy5mb3JFYWNoKG1vZGVsID0+IGNiLmFkZE9wdGlvbihtb2RlbCwgbW9kZWwpKTtcclxuICAgICAgICAgIGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGVsIHx8IHNlcnZpY2UubW9kZWxzWzBdKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9kZWwgPSB2OyB0aGlzLmRlYm91bmNlZFNhdmUoKTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKFsnb3BlbmFpJywgJ2FudGhyb3BpYyddLmluY2x1ZGVzKHByb3ZpZGVyKSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlLZXkpIHtcclxuICAgICAgLy8gU2hvdyBsb2FkaW5nIHN0YXRlIHdoaWxlIGZldGNoaW5nIG1vZGVsc1xyXG4gICAgICBjb25zdCBsb2FkaW5nU2V0dGluZyA9IG5ldyBTZXR0aW5nKG1vZGVsQ29udGFpbmVyKVxyXG4gICAgICAgIC5zZXROYW1lKCdNb2RlbCcpXHJcbiAgICAgICAgLnNldERlc2MoJ0xvYWRpbmcgYXZhaWxhYmxlIG1vZGVscy4uLicpO1xyXG4gICAgICBcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhdmFpbGFibGVNb2RlbHMgPSBhd2FpdCB0aGlzLnBsdWdpbi5mZXRjaENsb3VkTW9kZWxzKHByb3ZpZGVyIGFzICdvcGVuYWknIHwgJ2FudGhyb3BpYycpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENsZWFyIGxvYWRpbmcgc3RhdGUgYW5kIHNob3cgYWN0dWFsIGRyb3Bkb3duXHJcbiAgICAgICAgbW9kZWxDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICBcclxuICAgICAgICBuZXcgU2V0dGluZyhtb2RlbENvbnRhaW5lcilcclxuICAgICAgICAgIC5zZXROYW1lKCdNb2RlbCcpXHJcbiAgICAgICAgICAuc2V0RGVzYyhgU2VsZWN0IGZyb20gJHthdmFpbGFibGVNb2RlbHMubGVuZ3RofSBhdmFpbGFibGUgJHtwcm92aWRlcn0gbW9kZWxzLmApXHJcbiAgICAgICAgICAuYWRkRHJvcGRvd24oY2IgPT4ge1xyXG4gICAgICAgICAgICBhdmFpbGFibGVNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiBjYi5hZGRPcHRpb24obW9kZWwsIG1vZGVsKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGVsO1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0TW9kZWwgPSBhdmFpbGFibGVNb2RlbHMuaW5jbHVkZXMoY3VycmVudE1vZGVsKSA/IGN1cnJlbnRNb2RlbCA6IGF2YWlsYWJsZU1vZGVsc1swXTtcclxuICAgICAgICAgICAgY2Iuc2V0VmFsdWUoZGVmYXVsdE1vZGVsKVxyXG4gICAgICAgICAgICAgIC5vbkNoYW5nZSgodikgPT4geyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2RlbCA9IHY7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIHJlZnJlc2ggYnV0dG9uXHJcbiAgICAgICAgbmV3IFNldHRpbmcobW9kZWxDb250YWluZXIpXHJcbiAgICAgICAgICAuc2V0TmFtZSgnUmVmcmVzaCBNb2RlbHMnKVxyXG4gICAgICAgICAgLnNldERlc2MoJ1JlbG9hZCB0aGUgbGlzdCBvZiBhdmFpbGFibGUgbW9kZWxzIGZyb20gdGhlIEFQSS4nKVxyXG4gICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZWZyZXNoJylcclxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLmNsb3VkTW9kZWxDYWNoZS5jbGVhcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbW9kZWxDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICB0aGlzLmFkZEZhbGxiYWNrTW9kZWxTZXR0aW5nKG1vZGVsQ29udGFpbmVyLCBwcm92aWRlcik7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEZhbGxiYWNrIHRvIHRleHQgaW5wdXRcclxuICAgICAgdGhpcy5hZGRGYWxsYmFja01vZGVsU2V0dGluZyhtb2RlbENvbnRhaW5lciwgcHJvdmlkZXIpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBwcml2YXRlIGFkZEZhbGxiYWNrTW9kZWxTZXR0aW5nKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHByb3ZpZGVyOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGRlZmF1bHRNb2RlbHMgPSB7XHJcbiAgICAgIG9wZW5haTogJ2dwdC00by1taW5pJyxcclxuICAgICAgYW50aHJvcGljOiAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxyXG4gICAgICBvbGxhbWE6ICdsbGFtYTMuMicsXHJcbiAgICAgIGxtc3R1ZGlvOiAnbG9jYWwtbW9kZWwnXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IFsnb2xsYW1hJywgJ2xtc3R1ZGlvJ10uaW5jbHVkZXMocHJvdmlkZXIpIFxyXG4gICAgICA/IGBFbnRlciBtb2RlbCBuYW1lLiBTZXJ2aWNlIG5vdCBkZXRlY3RlZCBvciBubyBtb2RlbHMgYXZhaWxhYmxlLmBcclxuICAgICAgOiBgRW50ZXIgbW9kZWwgbmFtZSBtYW51YWxseS5gO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXHJcbiAgICAgIC5zZXROYW1lKCdNb2RlbCcpXHJcbiAgICAgIC5zZXREZXNjKGRlc2NyaXB0aW9uKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoZGVmYXVsdE1vZGVsc1twcm92aWRlciBhcyBrZXlvZiB0eXBlb2YgZGVmYXVsdE1vZGVsc10gfHwgJycpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGVsKVxyXG4gICAgICAgIC5vbkNoYW5nZSgodikgPT4geyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2RlbCA9IHYudHJpbSgpOyB0aGlzLmRlYm91bmNlZFNhdmUoKTsgfSkpO1xyXG4gIH1cclxuICBcclxuICBwcml2YXRlIGFkZExvY2FsTExNU2VjdGlvbihjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0xvY2FsIExMTSBDb25maWd1cmF0aW9uJyB9KTtcclxuICAgIFxyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyID09PSAnb2xsYW1hJykge1xyXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnT2xsYW1hIFVSTCcpXHJcbiAgICAgICAgLnNldERlc2MoJ1VSTCBmb3IgeW91ciBPbGxhbWEgaW5zdGFuY2UuJylcclxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFVcmwpXHJcbiAgICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYVVybCA9IHYudHJpbSgpOyBcclxuICAgICAgICAgICAgdGhpcy5kZWJvdW5jZWRTYXZlKCk7XHJcbiAgICAgICAgICAgIC8vIFNlcnZpY2Ugd2lsbCBiZSByZS1kZXRlY3RlZCBvbiBuZXh0IHVzZSBkdWUgdG8gVVJMIGNoYW5nZVxyXG4gICAgICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIgPT09ICdsbXN0dWRpbycpIHtcclxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0xNIFN0dWRpbyBVUkwnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVUkwgZm9yIHlvdXIgTE0gU3R1ZGlvIGluc3RhbmNlLicpXHJcbiAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubG1zdHVkaW9VcmwpXHJcbiAgICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxtc3R1ZGlvVXJsID0gdi50cmltKCk7IFxyXG4gICAgICAgICAgICB0aGlzLmRlYm91bmNlZFNhdmUoKTtcclxuICAgICAgICAgICAgLy8gU2VydmljZSB3aWxsIGJlIHJlLWRldGVjdGVkIG9uIG5leHQgdXNlIGR1ZSB0byBVUkwgY2hhbmdlXHJcbiAgICAgICAgICB9KSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnTW9kZWwgUmVmcmVzaCBJbnRlcnZhbCcpXHJcbiAgICAgIC5zZXREZXNjKCdIb3cgb2Z0ZW4gdG8gY2hlY2sgZm9yIGF2YWlsYWJsZSBtb2RlbHMgKG1pbnV0ZXMpLicpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMSwgNjAsIDEpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxvY2FsTW9kZWxSZWZyZXNoSW50ZXJ2YWwpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgXHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb2NhbE1vZGVsUmVmcmVzaEludGVydmFsID0gdjsgXHJcbiAgICAgICAgICB0aGlzLmRlYm91bmNlZFNhdmUoKTtcclxuICAgICAgICAgIC8vIE5vdGU6IFNlcnZpY2UgbW9uaXRvcmluZyBub3cgdXNlcyBvbi1kZW1hbmQgZGV0ZWN0aW9uXHJcbiAgICAgICAgfSkpO1xyXG4gIH1cclxuICBcclxuICBwcml2YXRlIGFkZFByb2Nlc3NpbmdTZWN0aW9uKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUHJvY2Vzc2luZyBTZXR0aW5ncycgfSk7XHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnT3duZXIgbmFtZScpXHJcbiAgICAgIC5zZXREZXNjKCdFeGFjdCBuYW1lIHRoZSBMTE0gc2hvdWxkIGxvb2sgZm9yIHdoZW4gZGVjaWRpbmcgdGFza3MuJylcclxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdCcnlhbiBLb2xiJylcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3duZXJOYW1lKVxyXG4gICAgICAgIC5vbkNoYW5nZSgodikgPT4geyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vd25lck5hbWUgPSB2LnRyaW0oKTsgdGhpcy5kZWJvdW5jZWRTYXZlKCk7IH0pKTtcclxuICAgIFxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdUYXNrcyBmb2xkZXInKVxyXG4gICAgICAuc2V0RGVzYygnRm9sZGVyIHdoZXJlIGdlbmVyYXRlZCB0YXNrIG5vdGVzIHdpbGwgYmUgY3JlYXRlZC4nKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFza3NGb2xkZXIpXHJcbiAgICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLnRhc2tzRm9sZGVyID0gdi50cmltKCk7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KSk7XHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnVHJpZ2dlciBub3RlIHR5cGVzJylcclxuICAgICAgLnNldERlc2MoJ0NvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIG5vdGUgdHlwZXMgdG8gcHJvY2VzcyAoZnJvbSBmcm9udG1hdHRlciBUeXBlIGZpZWxkKS4nKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudHJpZ2dlclR5cGVzLmpvaW4oJywgJykpXHJcbiAgICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7IFxyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudHJpZ2dlclR5cGVzID0gdi5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKS5maWx0ZXIocyA9PiBzLmxlbmd0aCA+IDApO1xyXG4gICAgICAgICAgdGhpcy5kZWJvdW5jZWRTYXZlKCk7IFxyXG4gICAgICAgIH0pKTtcclxuICAgIFxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdQcm9jZXNzIGVkaXRzIGFzIHdlbGwgYXMgbmV3IGZpbGVzJylcclxuICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZWQsIG1vZGlmaWNhdGlvbnMgdG8gbWF0Y2hpbmcgbm90ZXMgd2lsbCBiZSBwcm9jZXNzZWQgdG9vLicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9jZXNzT25VcGRhdGUpXHJcbiAgICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb2Nlc3NPblVwZGF0ZSA9IHY7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KSk7XHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnTGluayBiYWNrIHRvIHNvdXJjZScpXHJcbiAgICAgIC5zZXREZXNjKCdJbnNlcnQgYSBsaW5rIGJhY2sgdG8gdGhlIHNvdXJjZSBub3RlIGluIGdlbmVyYXRlZCB0YXNrIG5vdGVzLicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rQmFjaylcclxuICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua0JhY2sgPSB2OyB0aGlzLmRlYm91bmNlZFNhdmUoKTsgfSkpO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1Byb2Nlc3NlZCBtYXJrZXIga2V5JylcclxuICAgICAgLnNldERlc2MoJ0Zyb250bWF0dGVyIGtleSB0byBtYXJrIHByb2Nlc3NlZCBub3Rlcy4nKVxyXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvY2Vzc2VkRnJvbnRtYXR0ZXJLZXkpXHJcbiAgICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb2Nlc3NlZEZyb250bWF0dGVyS2V5ID0gdi50cmltKCk7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KSk7XHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgYWRkRnJvbnRtYXR0ZXJTZWN0aW9uKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnVGFzayBOb3RlIEZyb250bWF0dGVyJyB9KTtcclxuICAgIFxyXG4gICAgLy8gQWRkIGZpZWxkIGJ1dHRvblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdBZGQgRmllbGQnKVxyXG4gICAgICAuc2V0RGVzYygnQWRkIGEgbmV3IGZyb250bWF0dGVyIGZpZWxkJylcclxuICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FkZCBGaWVsZCcpXHJcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJvbnRtYXR0ZXJGaWVsZHMucHVzaCh7XHJcbiAgICAgICAgICAgIGtleTogJ25ld19maWVsZCcsXHJcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJycsXHJcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHRoaXMuZGVib3VuY2VkU2F2ZSgpO1xyXG4gICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgXHJcbiAgICAvLyBEaXNwbGF5IGV4aXN0aW5nIGZpZWxkc1xyXG4gICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJvbnRtYXR0ZXJGaWVsZHMuZm9yRWFjaCgoZmllbGQsIGluZGV4KSA9PiB7XHJcbiAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAndGFzay1leHRyYWN0b3ItZmllbGQnIH0pO1xyXG4gICAgICBcclxuICAgICAgbmV3IFNldHRpbmcoZmllbGRDb250YWluZXIpXHJcbiAgICAgICAgLnNldE5hbWUoYEZpZWxkICR7aW5kZXggKyAxfTogJHtmaWVsZC5rZXl9YClcclxuICAgICAgICAuc2V0RGVzYyhgVHlwZTogJHtmaWVsZC50eXBlfSwgUmVxdWlyZWQ6ICR7ZmllbGQucmVxdWlyZWQgPyAnWWVzJyA6ICdObyd9YClcclxuICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cclxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZW1vdmUnKVxyXG4gICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcm9udG1hdHRlckZpZWxkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmRlYm91bmNlZFNhdmUoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICB9KSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gQ3VzdG9tIHByb21wdFxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdDdXN0b20gUHJvbXB0JylcclxuICAgICAgLnNldERlc2MoJ092ZXJyaWRlIHRoZSBkZWZhdWx0IHRhc2sgZXh0cmFjdGlvbiBwcm9tcHQuIExlYXZlIGVtcHR5IHRvIHVzZSBkZWZhdWx0LicpXHJcbiAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGN1c3RvbSBwcm9tcHQuLi4nKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Qcm9tcHQpXHJcbiAgICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdCA9IHY7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KSk7XHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgYWRkQWR2YW5jZWRTZWN0aW9uKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQWR2YW5jZWQgU2V0dGluZ3MnIH0pO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ01heCBUb2tlbnMnKVxyXG4gICAgICAuc2V0RGVzYygnTWF4aW11bSB0b2tlbnMgdG8gZ2VuZXJhdGUuJylcclxuICAgICAgLmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXHJcbiAgICAgICAgLnNldExpbWl0cygxMDAsIDIwMDAsIDUwKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhUb2tlbnMpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4VG9rZW5zID0gdjsgdGhpcy5kZWJvdW5jZWRTYXZlKCk7IH0pKTtcclxuICAgIFxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdUZW1wZXJhdHVyZScpXHJcbiAgICAgIC5zZXREZXNjKCdDcmVhdGl2aXR5IGxldmVsICgwID0gZGV0ZXJtaW5pc3RpYywgMSA9IGNyZWF0aXZlKS4nKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDAsIDEsIDAuMSlcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGVyYXR1cmUpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGVyYXR1cmUgPSB2OyB0aGlzLmRlYm91bmNlZFNhdmUoKTsgfSkpO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1RpbWVvdXQgKHNlY29uZHMpJylcclxuICAgICAgLnNldERlc2MoJ1JlcXVlc3QgdGltZW91dCBmb3IgTExNIGNhbGxzLicpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMTAsIDEyMCwgNSlcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGltZW91dClcclxuICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxyXG4gICAgICAgIC5vbkNoYW5nZSgodikgPT4geyB0aGlzLnBsdWdpbi5zZXR0aW5ncy50aW1lb3V0ID0gdjsgdGhpcy5kZWJvdW5jZWRTYXZlKCk7IH0pKTtcclxuICAgIFxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdSZXRyeSBBdHRlbXB0cycpXHJcbiAgICAgIC5zZXREZXNjKCdOdW1iZXIgb2YgcmV0cnkgYXR0ZW1wdHMgZm9yIGZhaWxlZCByZXF1ZXN0cy4nKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDEsIDUsIDEpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJldHJpZXMpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoKHYpID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmV0cmllcyA9IHY7IHRoaXMuZGVib3VuY2VkU2F2ZSgpOyB9KSk7XHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgdXBkYXRlU2VydmljZVN0YXR1cyhzdGF0dXNFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIHN0YXR1c0VsLmVtcHR5KCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXI7XHJcbiAgICBjb25zdCBzZXJ2aWNlID0gdGhpcy5wbHVnaW4uc2VydmljZUNhY2hlLmdldChwcm92aWRlcik7XHJcbiAgICBcclxuICAgIGlmIChbJ29sbGFtYScsICdsbXN0dWRpbyddLmluY2x1ZGVzKHByb3ZpZGVyKSkge1xyXG4gICAgICBpZiAoc2VydmljZT8uYXZhaWxhYmxlKSB7XHJcbiAgICAgICAgc3RhdHVzRWwuY3JlYXRlRWwoJ2RpdicsIHsgXHJcbiAgICAgICAgICB0ZXh0OiBgXHUyNzA1ICR7cHJvdmlkZXJ9IGNvbm5lY3RlZCAoJHtzZXJ2aWNlLm1vZGVscy5sZW5ndGh9IG1vZGVscylgLFxyXG4gICAgICAgICAgY2xzOiAndGFzay1leHRyYWN0b3Itc3RhdHVzLXN1Y2Nlc3MnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RhdHVzRWwuY3JlYXRlRWwoJ2RpdicsIHsgXHJcbiAgICAgICAgICB0ZXh0OiBgXHUyNzRDICR7cHJvdmlkZXJ9IG5vdCBhdmFpbGFibGVgLFxyXG4gICAgICAgICAgY2xzOiAndGFzay1leHRyYWN0b3Itc3RhdHVzLWVycm9yJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpS2V5KSB7XHJcbiAgICAgICAgc3RhdHVzRWwuY3JlYXRlRWwoJ2RpdicsIHsgXHJcbiAgICAgICAgICB0ZXh0OiBgXHUyNzA1ICR7cHJvdmlkZXJ9IEFQSSBrZXkgY29uZmlndXJlZGAsXHJcbiAgICAgICAgICBjbHM6ICd0YXNrLWV4dHJhY3Rvci1zdGF0dXMtc3VjY2VzcydcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzdGF0dXNFbC5jcmVhdGVFbCgnZGl2JywgeyBcclxuICAgICAgICAgIHRleHQ6IGBcdTI3NEMgJHtwcm92aWRlcn0gQVBJIGtleSByZXF1aXJlZGAsXHJcbiAgICAgICAgICBjbHM6ICd0YXNrLWV4dHJhY3Rvci1zdGF0dXMtZXJyb3InXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn0iLCAiLypcclxuICogVHlwZSBkZWZpbml0aW9ucyBmb3IgVGFzayBFeHRyYWN0b3IgUGx1Z2luXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGcm9udG1hdHRlckZpZWxkIHtcclxuICBrZXk6IHN0cmluZztcclxuICBkZWZhdWx0VmFsdWU6IHN0cmluZztcclxuICB0eXBlOiAndGV4dCcgfCAnZGF0ZScgfCAnc2VsZWN0JyB8ICdib29sZWFuJztcclxuICBvcHRpb25zPzogc3RyaW5nW107IC8vIGZvciBzZWxlY3QgdHlwZVxyXG4gIHJlcXVpcmVkOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIExMTVNlcnZpY2Uge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBhdmFpbGFibGU6IGJvb2xlYW47XHJcbiAgbW9kZWxzOiBzdHJpbmdbXTtcclxuICBsYXN0Q2hlY2tlZDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4dHJhY3RvclNldHRpbmdzIHtcclxuICBwcm92aWRlcjogJ29wZW5haScgfCAnYW50aHJvcGljJyB8ICdvbGxhbWEnIHwgJ2xtc3R1ZGlvJztcclxuICBhcGlLZXk6IHN0cmluZztcclxuICBtb2RlbDogc3RyaW5nO1xyXG4gIFxyXG4gIC8vIExvY2FsIExMTSBzZXR0aW5nc1xyXG4gIG9sbGFtYVVybDogc3RyaW5nO1xyXG4gIGxtc3R1ZGlvVXJsOiBzdHJpbmc7XHJcbiAgbG9jYWxNb2RlbFJlZnJlc2hJbnRlcnZhbDogbnVtYmVyOyAvLyBtaW51dGVzXHJcbiAgXHJcbiAgLy8gUHJvY2Vzc2luZyBzZXR0aW5nc1xyXG4gIHRhc2tzRm9sZGVyOiBzdHJpbmc7XHJcbiAgbGlua0JhY2s6IGJvb2xlYW47XHJcbiAgcHJvY2Vzc2VkRnJvbnRtYXR0ZXJLZXk6IHN0cmluZztcclxuICBvd25lck5hbWU6IHN0cmluZztcclxuICBwcm9jZXNzT25VcGRhdGU6IGJvb2xlYW47XHJcbiAgdHJpZ2dlclR5cGVzOiBzdHJpbmdbXTsgLy8gY3VzdG9taXphYmxlIG5vdGUgdHlwZXMgdG8gcHJvY2Vzc1xyXG4gIFxyXG4gIC8vIEN1c3RvbWl6YWJsZSBmcm9udG1hdHRlclxyXG4gIGZyb250bWF0dGVyRmllbGRzOiBGcm9udG1hdHRlckZpZWxkW107XHJcbiAgY3VzdG9tUHJvbXB0OiBzdHJpbmc7XHJcbiAgXHJcbiAgLy8gQWR2YW5jZWQgc2V0dGluZ3NcclxuICBtYXhUb2tlbnM6IG51bWJlcjtcclxuICB0ZW1wZXJhdHVyZTogbnVtYmVyO1xyXG4gIHRpbWVvdXQ6IG51bWJlcjsgLy8gc2Vjb25kc1xyXG4gIHJldHJpZXM6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFeHRyYWN0ZWRUYXNrIHtcclxuICB0YXNrX3RpdGxlOiBzdHJpbmc7XHJcbiAgdGFza19kZXRhaWxzOiBzdHJpbmc7XHJcbiAgZHVlX2RhdGU/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHByaW9yaXR5PzogJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcclxuICBwcm9qZWN0Pzogc3RyaW5nIHwgbnVsbDtcclxuICBjbGllbnQ/OiBzdHJpbmcgfCBudWxsO1xyXG4gIHNvdXJjZV9leGNlcnB0Pzogc3RyaW5nO1xyXG4gIGNvbmZpZGVuY2U/OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xyXG4gIFtrZXk6IHN0cmluZ106IGFueTsgLy8gQWxsb3cgYWRkaXRpb25hbCBleHRyYWN0ZWQgZmllbGRzXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGFza0V4dHJhY3Rpb25SZXN1bHQge1xyXG4gIGZvdW5kOiBib29sZWFuO1xyXG4gIHRhc2tzOiBFeHRyYWN0ZWRUYXNrW107XHJcbiAgY29uZmlkZW5jZT86ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdyc7XHJcbn1cclxuXHJcbi8vIEJhY2t3YXJkIGNvbXBhdGliaWxpdHkgdHlwZSBhbGlhc1xyXG5leHBvcnQgaW50ZXJmYWNlIFRhc2tFeHRyYWN0aW9uIHtcclxuICBmb3VuZDogYm9vbGVhbjtcclxuICB0YXNrX3RpdGxlPzogc3RyaW5nO1xyXG4gIHRhc2tfZGV0YWlscz86IHN0cmluZztcclxuICBkdWVfZGF0ZT86IHN0cmluZyB8IG51bGw7XHJcbiAgcHJpb3JpdHk/OiBzdHJpbmc7XHJcbiAgc291cmNlX2V4Y2VycHQ/OiBzdHJpbmc7XHJcbiAgW2tleTogc3RyaW5nXTogYW55OyAvLyBBbGxvdyBhZGRpdGlvbmFsIGV4dHJhY3RlZCBmaWVsZHNcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRlJPTlRNQVRURVJfRklFTERTOiBGcm9udG1hdHRlckZpZWxkW10gPSBbXHJcbiAgeyBrZXk6ICd0YXNrJywgZGVmYXVsdFZhbHVlOiAnJywgdHlwZTogJ3RleHQnLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHsga2V5OiAnc3RhdHVzJywgZGVmYXVsdFZhbHVlOiAnaW5ib3gnLCB0eXBlOiAnc2VsZWN0Jywgb3B0aW9uczogWydpbmJveCcsICduZXh0JywgJ3dhaXRpbmcnLCAnc29tZWRheScsICdkb25lJywgJ2NhbmNlbGxlZCddLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHsga2V5OiAncHJpb3JpdHknLCBkZWZhdWx0VmFsdWU6ICdtZWRpdW0nLCB0eXBlOiAnc2VsZWN0Jywgb3B0aW9uczogWydsb3cnLCAnbWVkaXVtJywgJ2hpZ2gnLCAndXJnZW50J10sIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgeyBrZXk6ICdkdWUnLCBkZWZhdWx0VmFsdWU6ICcnLCB0eXBlOiAnZGF0ZScsIHJlcXVpcmVkOiBmYWxzZSB9LFxyXG4gIHsga2V5OiAncHJvamVjdCcsIGRlZmF1bHRWYWx1ZTogJycsIHR5cGU6ICd0ZXh0JywgcmVxdWlyZWQ6IGZhbHNlIH0sXHJcbiAgeyBrZXk6ICdjbGllbnQnLCBkZWZhdWx0VmFsdWU6ICcnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiBmYWxzZSB9LFxyXG4gIHsga2V5OiAnY3JlYXRlZCcsIGRlZmF1bHRWYWx1ZTogJ3t7ZGF0ZX19JywgdHlwZTogJ2RhdGUnLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHsga2V5OiAndGFncycsIGRlZmF1bHRWYWx1ZTogJ3Rhc2snLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiBmYWxzZSB9XHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRXh0cmFjdG9yU2V0dGluZ3MgPSB7XHJcbiAgcHJvdmlkZXI6ICdvcGVuYWknLFxyXG4gIGFwaUtleTogJycsXHJcbiAgbW9kZWw6ICdncHQtNG8tbWluaScsXHJcbiAgXHJcbiAgLy8gTG9jYWwgTExNIHNldHRpbmdzXHJcbiAgb2xsYW1hVXJsOiAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcsXHJcbiAgbG1zdHVkaW9Vcmw6ICdodHRwOi8vbG9jYWxob3N0OjEyMzQnLFxyXG4gIGxvY2FsTW9kZWxSZWZyZXNoSW50ZXJ2YWw6IDUsXHJcbiAgXHJcbiAgLy8gUHJvY2Vzc2luZyBzZXR0aW5nc1xyXG4gIHRhc2tzRm9sZGVyOiAnVGFza3MnLFxyXG4gIGxpbmtCYWNrOiB0cnVlLFxyXG4gIHByb2Nlc3NlZEZyb250bWF0dGVyS2V5OiAndGFza0V4dHJhY3Rvci5wcm9jZXNzZWQnLFxyXG4gIG93bmVyTmFtZTogJ0JyeWFuIEtvbGInLFxyXG4gIHByb2Nlc3NPblVwZGF0ZTogZmFsc2UsXHJcbiAgdHJpZ2dlclR5cGVzOiBbJ2VtYWlsJywgJ21lZXRpbmdub3RlJywgJ21lZXRpbmcgbm90ZScsICdtZWV0aW5nIG5vdGVzJ10sXHJcbiAgXHJcbiAgLy8gQ3VzdG9taXphYmxlIGZyb250bWF0dGVyXHJcbiAgZnJvbnRtYXR0ZXJGaWVsZHM6IERFRkFVTFRfRlJPTlRNQVRURVJfRklFTERTLFxyXG4gIGN1c3RvbVByb21wdDogJycsXHJcbiAgXHJcbiAgLy8gQWR2YW5jZWQgc2V0dGluZ3NcclxuICBtYXhUb2tlbnM6IDgwMCxcclxuICB0ZW1wZXJhdHVyZTogMCxcclxuICB0aW1lb3V0OiAzMCxcclxuICByZXRyaWVzOiAzLFxyXG59OyIsICIvKlxyXG4gKiBMTE0gUHJvdmlkZXIgaW1wbGVtZW50YXRpb25zIGFuZCBzZXJ2aWNlIGRldGVjdGlvblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEV4dHJhY3RvclNldHRpbmdzLCBMTE1TZXJ2aWNlIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgTExNUHJvdmlkZXJNYW5hZ2VyIHtcclxuICBwcml2YXRlIHNlcnZpY2VDYWNoZTogTWFwPHN0cmluZywgTExNU2VydmljZT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBjbG91ZE1vZGVsQ2FjaGU6IE1hcDxzdHJpbmcsIHN0cmluZ1tdPiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIGFwaUtleU1pc3NpbmdOb3RpZmllZDogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEV4dHJhY3RvclNldHRpbmdzKSB7fVxyXG5cclxuICAvLyBHZXQgc2VydmljZSB3aXRoIDMwLW1pbnV0ZSBjYWNoZSBUVExcclxuICBhc3luYyBnZXRTZXJ2aWNlKHByb3ZpZGVyOiBzdHJpbmcpOiBQcm9taXNlPExMTVNlcnZpY2UgfCBudWxsPiB7XHJcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLnNlcnZpY2VDYWNoZS5nZXQocHJvdmlkZXIpO1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IGNhY2hlVmFsaWRNcyA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzXHJcbiAgICBcclxuICAgIGlmIChjYWNoZWQgJiYgKG5vdyAtIGNhY2hlZC5sYXN0Q2hlY2tlZCkgPCBjYWNoZVZhbGlkTXMpIHtcclxuICAgICAgcmV0dXJuIGNhY2hlZDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZGV0ZWN0U2luZ2xlU2VydmljZShwcm92aWRlcik7XHJcbiAgfVxyXG5cclxuICAvLyBEZXRlY3QgYSBzaW5nbGUgc2VydmljZSBpbnN0ZWFkIG9mIGFsbCBzZXJ2aWNlc1xyXG4gIHByaXZhdGUgYXN5bmMgZGV0ZWN0U2luZ2xlU2VydmljZShwcm92aWRlcjogc3RyaW5nKTogUHJvbWlzZTxMTE1TZXJ2aWNlIHwgbnVsbD4ge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIFxyXG4gICAgaWYgKHByb3ZpZGVyID09PSAnb2xsYW1hJykge1xyXG4gICAgICBjb25zdCBzZXJ2aWNlOiBMTE1TZXJ2aWNlID0ge1xyXG4gICAgICAgIG5hbWU6ICdvbGxhbWEnLFxyXG4gICAgICAgIHVybDogdGhpcy5zZXR0aW5ncy5vbGxhbWFVcmwsXHJcbiAgICAgICAgYXZhaWxhYmxlOiBmYWxzZSxcclxuICAgICAgICBtb2RlbHM6IFtdLFxyXG4gICAgICAgIGxhc3RDaGVja2VkOiBub3dcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmF3UmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcclxuICAgICAgICAgIHVybDogYCR7dGhpcy5zZXR0aW5ncy5vbGxhbWFVcmx9L2FwaS90YWdzYCxcclxuICAgICAgICAgIG1ldGhvZDogJ0dFVCdcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IHRoaXMuYWRhcHRSZXF1ZXN0VXJsUmVzcG9uc2UocmF3UmVzcG9uc2UpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICAgIHNlcnZpY2UuYXZhaWxhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgIHNlcnZpY2UubW9kZWxzID0gZGF0YS5tb2RlbHM/Lm1hcCgobTogYW55KSA9PiBtLm5hbWUpIHx8IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnT2xsYW1hIG5vdCBhdmFpbGFibGU6JywgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHRoaXMuc2VydmljZUNhY2hlLnNldCgnb2xsYW1hJywgc2VydmljZSk7XHJcbiAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocHJvdmlkZXIgPT09ICdsbXN0dWRpbycpIHtcclxuICAgICAgY29uc3Qgc2VydmljZTogTExNU2VydmljZSA9IHtcclxuICAgICAgICBuYW1lOiAnbG1zdHVkaW8nLFxyXG4gICAgICAgIHVybDogdGhpcy5zZXR0aW5ncy5sbXN0dWRpb1VybCxcclxuICAgICAgICBhdmFpbGFibGU6IGZhbHNlLFxyXG4gICAgICAgIG1vZGVsczogW10sXHJcbiAgICAgICAgbGFzdENoZWNrZWQ6IG5vd1xyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByYXdSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xyXG4gICAgICAgICAgdXJsOiBgJHt0aGlzLnNldHRpbmdzLmxtc3R1ZGlvVXJsfS92MS9tb2RlbHNgLFxyXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gdGhpcy5hZGFwdFJlcXVlc3RVcmxSZXNwb25zZShyYXdSZXNwb25zZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgICAgc2VydmljZS5hdmFpbGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgc2VydmljZS5tb2RlbHMgPSBkYXRhLmRhdGE/Lm1hcCgobTogYW55KSA9PiBtLmlkKSB8fCBbXTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0xNIFN0dWRpbyBub3QgYXZhaWxhYmxlOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLnNlcnZpY2VDYWNoZS5zZXQoJ2xtc3R1ZGlvJywgc2VydmljZSk7XHJcbiAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8vIExlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICBhc3luYyBkZXRlY3RTZXJ2aWNlcygpOiBQcm9taXNlPE1hcDxzdHJpbmcsIExMTVNlcnZpY2U+PiB7XHJcbiAgICBhd2FpdCB0aGlzLmdldFNlcnZpY2UoJ29sbGFtYScpO1xyXG4gICAgYXdhaXQgdGhpcy5nZXRTZXJ2aWNlKCdsbXN0dWRpbycpO1xyXG4gICAgcmV0dXJuIHRoaXMuc2VydmljZUNhY2hlO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXZhaWxhYmxlU2VydmljZXMoKTogTExNU2VydmljZVtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuc2VydmljZUNhY2hlLnZhbHVlcygpKS5maWx0ZXIocyA9PiBzLmF2YWlsYWJsZSk7XHJcbiAgfVxyXG5cclxuICAvLyBQcm92aWRlci1hZ25vc3RpYyBMTE0gY2FsbCB3aXRoIGZhbGxiYWNrIHN1cHBvcnRcclxuICBhc3luYyBjYWxsTExNKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5zZXR0aW5ncy5wcm92aWRlcjtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgQVBJIGtleSBpcyByZXF1aXJlZCBmb3IgY2xvdWQgcHJvdmlkZXJzIChvbmx5IG5vdGlmeSBvbmNlIHBlciBwcm92aWRlcilcclxuICAgIGlmIChbJ29wZW5haScsICdhbnRocm9waWMnXS5pbmNsdWRlcyhwcm92aWRlcikgJiYgIXRoaXMuc2V0dGluZ3MuYXBpS2V5KSB7XHJcbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbktleSA9IGAke3Byb3ZpZGVyfS1uby1hcGkta2V5YDtcclxuICAgICAgaWYgKCF0aGlzLmFwaUtleU1pc3NpbmdOb3RpZmllZC5oYXMobm90aWZpY2F0aW9uS2V5KSkge1xyXG4gICAgICAgIC8vIE5vdGU6IE5vdGljZSB3b3VsZCBuZWVkIHRvIGJlIHBhc3NlZCBpbiBvciBoYW5kbGVkIGJ5IGNhbGxlclxyXG4gICAgICAgIGNvbnNvbGUud2FybihgVGFzayBFeHRyYWN0b3I6ICR7cHJvdmlkZXIudG9VcHBlckNhc2UoKX0gQVBJIGtleSBub3QgY29uZmlndXJlZCBpbiBwbHVnaW4gc2V0dGluZ3NgKTtcclxuICAgICAgICB0aGlzLmFwaUtleU1pc3NpbmdOb3RpZmllZC5hZGQobm90aWZpY2F0aW9uS2V5KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2xlYXIgbm90aWZpY2F0aW9uIGZsYWcgaWYgQVBJIGtleSBpcyBwcmVzZW50XHJcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5hcGlLZXkpIHtcclxuICAgICAgdGhpcy5hcGlLZXlNaXNzaW5nTm90aWZpZWQuZGVsZXRlKGAke3Byb3ZpZGVyfS1uby1hcGkta2V5YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRyeSBwcmltYXJ5IHByb3ZpZGVyIHdpdGggcmV0cmllc1xyXG4gICAgZm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPCB0aGlzLnNldHRpbmdzLnJldHJpZXM7IGF0dGVtcHQrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCByZXN1bHQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHN3aXRjaCAocHJvdmlkZXIpIHtcclxuICAgICAgICAgIGNhc2UgJ29wZW5haSc6XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuY2FsbE9wZW5BSShzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgJ2FudGhyb3BpYyc6XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuY2FsbEFudGhyb3BpYyhzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgJ29sbGFtYSc6XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuY2FsbE9sbGFtYShzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgJ2xtc3R1ZGlvJzpcclxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5jYWxsTE1TdHVkaW8oc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHByb3ZpZGVyOiAke3Byb3ZpZGVyfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIFxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgQXR0ZW1wdCAke2F0dGVtcHQgKyAxfSBmYWlsZWQgZm9yICR7cHJvdmlkZXJ9OmAsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChhdHRlbXB0ID09PSB0aGlzLnNldHRpbmdzLnJldHJpZXMgLSAxKSB7XHJcbiAgICAgICAgICAvLyBMYXN0IGF0dGVtcHQgZmFpbGVkLCB0cnkgZmFsbGJhY2sgZm9yIGxvY2FsIHByb3ZpZGVyc1xyXG4gICAgICAgICAgaWYgKFsnb2xsYW1hJywgJ2xtc3R1ZGlvJ10uaW5jbHVkZXMocHJvdmlkZXIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnRyeUxvY2FsRmFsbGJhY2soc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gV2FpdCBiZWZvcmUgcmV0cnkgd2l0aCBsaW5lYXIgYmFja29mZlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgxMDAwICogKGF0dGVtcHQgKyAxKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyB0cnlMb2NhbEZhbGxiYWNrKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGNvbnN0IGF2YWlsYWJsZVNlcnZpY2VzID0gdGhpcy5nZXRBdmFpbGFibGVTZXJ2aWNlcygpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2YgYXZhaWxhYmxlU2VydmljZXMpIHtcclxuICAgICAgaWYgKHNlcnZpY2UubmFtZSA9PT0gdGhpcy5zZXR0aW5ncy5wcm92aWRlcikgY29udGludWU7IC8vIFNraXAgcHJpbWFyeSB0aGF0IGFscmVhZHkgZmFpbGVkXHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBUcnlpbmcgZmFsbGJhY2sgdG8gJHtzZXJ2aWNlLm5hbWV9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHNlcnZpY2UubmFtZSA9PT0gJ29sbGFtYScpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNhbGxPbGxhbWEoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNlcnZpY2UubmFtZSA9PT0gJ2xtc3R1ZGlvJykge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY2FsbExNU3R1ZGlvKHN5c3RlbVByb21wdCwgdXNlclByb21wdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgRmFsbGJhY2sgdG8gJHtzZXJ2aWNlLm5hbWV9IGZhaWxlZDpgLCBlcnJvci5tZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLndhcm4oJ1Rhc2sgRXh0cmFjdG9yOiBBbGwgTExNIHNlcnZpY2VzIGZhaWxlZC4gQ2hlY2sgeW91ciBjb25maWd1cmF0aW9uLicpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGNhbGxPcGVuQUkoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgZW5kcG9pbnQgPSAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJztcclxuICAgIGNvbnN0IGJvZHkgPSB7XHJcbiAgICAgIG1vZGVsOiB0aGlzLnNldHRpbmdzLm1vZGVsIHx8ICdncHQtNG8tbWluaScsXHJcbiAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXHJcbiAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxyXG4gICAgICBdLFxyXG4gICAgICB0ZW1wZXJhdHVyZTogdGhpcy5zZXR0aW5ncy50ZW1wZXJhdHVyZSxcclxuICAgICAgbWF4X3Rva2VuczogdGhpcy5zZXR0aW5ncy5tYXhUb2tlbnNcclxuICAgIH07XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmF3UmVzcCA9IGF3YWl0IHJlcXVlc3RVcmwoe1xyXG4gICAgICAgIHVybDogZW5kcG9pbnQsXHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5zZXR0aW5ncy5hcGlLZXl9YCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCByZXNwID0gdGhpcy5hZGFwdFJlcXVlc3RVcmxSZXNwb25zZShyYXdSZXNwKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghcmVzcC5vaykge1xyXG4gICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwLnRleHQoKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdPcGVuQUkgZXJyb3InLCByZXNwLnN0YXR1cywgdGV4dCk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3Auc3RhdHVzfSAke3Jlc3Auc3RhdHVzVGV4dH1gKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3AuanNvbigpO1xyXG4gICAgICByZXR1cm4ganNvbj8uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbGxPcGVuQUkgZXJyb3InLCBlKTtcclxuICAgICAgdGhyb3cgZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgY2FsbEFudGhyb3BpYyhzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcbiAgICBjb25zdCBlbmRwb2ludCA9ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJztcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmF3UmVzcCA9IGF3YWl0IHJlcXVlc3RVcmwoe1xyXG4gICAgICAgIHVybDogZW5kcG9pbnQsXHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ3gtYXBpLWtleSc6IHRoaXMuc2V0dGluZ3MuYXBpS2V5LFxyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbW9kZWw6IHRoaXMuc2V0dGluZ3MubW9kZWwgfHwgJ2NsYXVkZS0zLXNvbm5ldC0yMDI0MDIyOScsXHJcbiAgICAgICAgICBtYXhfdG9rZW5zOiB0aGlzLnNldHRpbmdzLm1heFRva2VucyxcclxuICAgICAgICAgIHRlbXBlcmF0dXJlOiB0aGlzLnNldHRpbmdzLnRlbXBlcmF0dXJlLFxyXG4gICAgICAgICAgc3lzdGVtOiBzeXN0ZW1Qcm9tcHQsXHJcbiAgICAgICAgICBtZXNzYWdlczogW3tcclxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgICBjb250ZW50OiB1c2VyUHJvbXB0XHJcbiAgICAgICAgICB9XVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCByZXNwID0gdGhpcy5hZGFwdFJlcXVlc3RVcmxSZXNwb25zZShyYXdSZXNwKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghcmVzcC5vaykge1xyXG4gICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwLnRleHQoKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdBbnRocm9waWMgZXJyb3InLCByZXNwLnN0YXR1cywgdGV4dCk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBbnRocm9waWMgQVBJIGVycm9yOiAke3Jlc3Auc3RhdHVzfSAke3Jlc3Auc3RhdHVzVGV4dH1gKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3AuanNvbigpO1xyXG4gICAgICByZXR1cm4ganNvbj8uY29udGVudD8uWzBdPy50ZXh0IHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbGxBbnRocm9waWMgZXJyb3InLCBlKTtcclxuICAgICAgdGhyb3cgZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgY2FsbE9sbGFtYShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcbiAgICBjb25zdCBzZXJ2aWNlID0gYXdhaXQgdGhpcy5nZXRTZXJ2aWNlKCdvbGxhbWEnKTtcclxuICAgIGlmICghc2VydmljZT8uYXZhaWxhYmxlIHx8ICFzZXJ2aWNlLm1vZGVscy5sZW5ndGgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgc2VydmljZSBub3QgYXZhaWxhYmxlIG9yIG5vIG1vZGVscyBsb2FkZWQnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVXNlIGNvbmZpZ3VyZWQgbW9kZWwgb3IgZmlyc3QgYXZhaWxhYmxlIG1vZGVsXHJcbiAgICBjb25zdCBtb2RlbCA9IHNlcnZpY2UubW9kZWxzLmluY2x1ZGVzKHRoaXMuc2V0dGluZ3MubW9kZWwpIFxyXG4gICAgICA/IHRoaXMuc2V0dGluZ3MubW9kZWwgXHJcbiAgICAgIDogc2VydmljZS5tb2RlbHNbMF07XHJcbiAgICBcclxuICAgIGNvbnN0IGVuZHBvaW50ID0gYCR7dGhpcy5zZXR0aW5ncy5vbGxhbWFVcmx9L2FwaS9jaGF0YDtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmF3UmVzcCA9IGF3YWl0IHJlcXVlc3RVcmwoe1xyXG4gICAgICAgIHVybDogZW5kcG9pbnQsXHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbW9kZWw6IG1vZGVsLFxyXG4gICAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXHJcbiAgICAgICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBzdHJlYW06IGZhbHNlLFxyXG4gICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGhpcy5zZXR0aW5ncy50ZW1wZXJhdHVyZSxcclxuICAgICAgICAgICAgbnVtX3ByZWRpY3Q6IHRoaXMuc2V0dGluZ3MubWF4VG9rZW5zXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnN0IHJlc3AgPSB0aGlzLmFkYXB0UmVxdWVzdFVybFJlc3BvbnNlKHJhd1Jlc3ApO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFyZXNwLm9rKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3AudGV4dCgpO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ09sbGFtYSBlcnJvcicsIHJlc3Auc3RhdHVzLCB0ZXh0KTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcC5zdGF0dXN9ICR7cmVzcC5zdGF0dXNUZXh0fWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzcC5qc29uKCk7XHJcbiAgICAgIHJldHVybiBqc29uPy5tZXNzYWdlPy5jb250ZW50IHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbGxPbGxhbWEgZXJyb3InLCBlKTtcclxuICAgICAgdGhyb3cgZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgY2FsbExNU3R1ZGlvKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGNvbnN0IHNlcnZpY2UgPSBhd2FpdCB0aGlzLmdldFNlcnZpY2UoJ2xtc3R1ZGlvJyk7XHJcbiAgICBpZiAoIXNlcnZpY2U/LmF2YWlsYWJsZSB8fCAhc2VydmljZS5tb2RlbHMubGVuZ3RoKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignTE0gU3R1ZGlvIHNlcnZpY2Ugbm90IGF2YWlsYWJsZSBvciBubyBtb2RlbHMgbG9hZGVkJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFVzZSBjb25maWd1cmVkIG1vZGVsIG9yIGZpcnN0IGF2YWlsYWJsZSBtb2RlbFxyXG4gICAgY29uc3QgbW9kZWwgPSBzZXJ2aWNlLm1vZGVscy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLm1vZGVsKSBcclxuICAgICAgPyB0aGlzLnNldHRpbmdzLm1vZGVsIFxyXG4gICAgICA6IHNlcnZpY2UubW9kZWxzWzBdO1xyXG4gICAgXHJcbiAgICBjb25zdCBlbmRwb2ludCA9IGAke3RoaXMuc2V0dGluZ3MubG1zdHVkaW9Vcmx9L3YxL2NoYXQvY29tcGxldGlvbnNgO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByYXdSZXNwID0gYXdhaXQgcmVxdWVzdFVybCh7XHJcbiAgICAgICAgdXJsOiBlbmRwb2ludCxcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgbG0tc3R1ZGlvJywgLy8gUGxhY2Vob2xkZXIgYXV0aFxyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbW9kZWw6IG1vZGVsLFxyXG4gICAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXHJcbiAgICAgICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogdGhpcy5zZXR0aW5ncy50ZW1wZXJhdHVyZSxcclxuICAgICAgICAgIG1heF90b2tlbnM6IHRoaXMuc2V0dGluZ3MubWF4VG9rZW5zXHJcbiAgICAgICAgfSlcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnN0IHJlc3AgPSB0aGlzLmFkYXB0UmVxdWVzdFVybFJlc3BvbnNlKHJhd1Jlc3ApO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFyZXNwLm9rKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3AudGV4dCgpO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xNIFN0dWRpbyBlcnJvcicsIHJlc3Auc3RhdHVzLCB0ZXh0KTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExNIFN0dWRpbyBBUEkgZXJyb3I6ICR7cmVzcC5zdGF0dXN9ICR7cmVzcC5zdGF0dXNUZXh0fWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzcC5qc29uKCk7XHJcbiAgICAgIHJldHVybiBqc29uPy5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgbnVsbDtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignY2FsbExNU3R1ZGlvIGVycm9yJywgZSk7XHJcbiAgICAgIHRocm93IGU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZvciBjbG91ZCBwcm92aWRlcnNcclxuICBhc3luYyBmZXRjaENsb3VkTW9kZWxzKHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdhbnRocm9waWMnKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgaWYgKCF0aGlzLnNldHRpbmdzLmFwaUtleSkge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XHJcbiAgICBjb25zdCBjYWNoZUtleSA9IGAke3Byb3ZpZGVyfS0ke3RoaXMuc2V0dGluZ3MuYXBpS2V5LnNsaWNlKC00KX1gOyAvLyBVc2UgbGFzdCA0IGNoYXJzIGZvciBjYWNoZSBrZXlcclxuICAgIGlmICh0aGlzLmNsb3VkTW9kZWxDYWNoZS5oYXMoY2FjaGVLZXkpKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNsb3VkTW9kZWxDYWNoZS5nZXQoY2FjaGVLZXkpIHx8IFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAocHJvdmlkZXIgPT09ICdvcGVuYWknKSB7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZmV0Y2hPcGVuQUlNb2RlbHMoKTtcclxuICAgICAgfSBlbHNlIGlmIChwcm92aWRlciA9PT0gJ2FudGhyb3BpYycpIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5mZXRjaEFudGhyb3BpY01vZGVscygpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBmZXRjaCAke3Byb3ZpZGVyfSBtb2RlbHM6YCwgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHRNb2RlbHMocHJvdmlkZXIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGZldGNoT3BlbkFJTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IHJhd1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XHJcbiAgICAgIHVybDogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvbW9kZWxzJyxcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuc2V0dGluZ3MuYXBpS2V5fWAsXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gdGhpcy5hZGFwdFJlcXVlc3RVcmxSZXNwb25zZShyYXdSZXNwb25zZSk7XHJcbiAgICBcclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIGNvbnN0IG1vZGVscyA9IGRhdGEuZGF0YVxyXG4gICAgICA/LmZpbHRlcigobW9kZWw6IGFueSkgPT4gbW9kZWwuaWQuaW5jbHVkZXMoJ2dwdCcpICYmICFtb2RlbC5pZC5pbmNsdWRlcygnaW5zdHJ1Y3QnKSlcclxuICAgICAgPy5tYXAoKG1vZGVsOiBhbnkpID0+IG1vZGVsLmlkKVxyXG4gICAgICA/LnNvcnQoKSB8fCBbXTtcclxuICAgIFxyXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdHNcclxuICAgIGNvbnN0IGNhY2hlS2V5ID0gYG9wZW5haS0ke3RoaXMuc2V0dGluZ3MuYXBpS2V5LnNsaWNlKC00KX1gO1xyXG4gICAgdGhpcy5jbG91ZE1vZGVsQ2FjaGUuc2V0KGNhY2hlS2V5LCBtb2RlbHMpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gbW9kZWxzLmxlbmd0aCA+IDAgPyBtb2RlbHMgOiB0aGlzLmdldERlZmF1bHRNb2RlbHMoJ29wZW5haScpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBmZXRjaEFudGhyb3BpY01vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICAvLyBBbnRocm9waWMgZG9lc24ndCBoYXZlIGEgbW9kZWxzIGVuZHBvaW50LCBzbyByZXR1cm4ga25vd24gbW9kZWxzXHJcbiAgICBjb25zdCBrbm93bk1vZGVscyA9IFtcclxuICAgICAgJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJyxcclxuICAgICAgJ2NsYXVkZS0zLTUtaGFpa3UtMjAyNDEwMjInLCBcclxuICAgICAgJ2NsYXVkZS0zLW9wdXMtMjAyNDAyMjknLFxyXG4gICAgICAnY2xhdWRlLTMtc29ubmV0LTIwMjQwMjI5JyxcclxuICAgICAgJ2NsYXVkZS0zLWhhaWt1LTIwMjQwMzA3J1xyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdHNcclxuICAgIGNvbnN0IGNhY2hlS2V5ID0gYGFudGhyb3BpYy0ke3RoaXMuc2V0dGluZ3MuYXBpS2V5LnNsaWNlKC00KX1gO1xyXG4gICAgdGhpcy5jbG91ZE1vZGVsQ2FjaGUuc2V0KGNhY2hlS2V5LCBrbm93bk1vZGVscyk7XHJcbiAgICBcclxuICAgIHJldHVybiBrbm93bk1vZGVscztcclxuICB9XHJcblxyXG4gIGdldERlZmF1bHRNb2RlbHMocHJvdmlkZXI6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGRlZmF1bHRzID0ge1xyXG4gICAgICBvcGVuYWk6IFsnZ3B0LTRvJywgJ2dwdC00by1taW5pJywgJ2dwdC00LXR1cmJvJywgJ2dwdC0zLjUtdHVyYm8nXSxcclxuICAgICAgYW50aHJvcGljOiBbJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJywgJ2NsYXVkZS0zLWhhaWt1LTIwMjQwMzA3J10sXHJcbiAgICAgIG9sbGFtYTogWydsbGFtYTMuMicsICdtaXN0cmFsJywgJ2NvZGVsbGFtYSddLFxyXG4gICAgICBsbXN0dWRpbzogWydsb2NhbC1tb2RlbCddXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gZGVmYXVsdHNbcHJvdmlkZXIgYXMga2V5b2YgdHlwZW9mIGRlZmF1bHRzXSB8fCBbXTtcclxuICB9XHJcblxyXG4gIC8vIFV0aWxpdHkgbWV0aG9kc1xyXG4gIHByaXZhdGUgZGVsYXkobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG4gIH1cclxuICBcclxuICBwcml2YXRlIGNyZWF0ZVRpbWVvdXRTaWduYWwobXM6IG51bWJlcik6IEFib3J0U2lnbmFsIHtcclxuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgbXMpO1xyXG4gICAgcmV0dXJuIGNvbnRyb2xsZXIuc2lnbmFsO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2xlYW51cCBtZXRob2RcclxuICBjbGVhbnVwKCkge1xyXG4gICAgdGhpcy5jbG91ZE1vZGVsQ2FjaGUuY2xlYXIoKTtcclxuICAgIHRoaXMuYXBpS2V5TWlzc2luZ05vdGlmaWVkLmNsZWFyKCk7XHJcbiAgICB0aGlzLnNlcnZpY2VDYWNoZS5jbGVhcigpO1xyXG4gIH1cclxuXHJcbiAgLy8gSGVscGVyIHRvIGFkYXB0IHJlcXVlc3RVcmwgcmVzcG9uc2UgdG8gZmV0Y2gtbGlrZSBpbnRlcmZhY2VcclxuICBwcml2YXRlIGFkYXB0UmVxdWVzdFVybFJlc3BvbnNlKHJlc3BvbnNlOiBhbnkpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG9rOiByZXNwb25zZS5zdGF0dXMgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1cyA8IDMwMCxcclxuICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXHJcbiAgICAgIHN0YXR1c1RleHQ6IHJlc3BvbnNlLnN0YXR1cy50b1N0cmluZygpLFxyXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiByZXNwb25zZS5qc29uLFxyXG4gICAgICB0ZXh0OiBhc3luYyAoKSA9PiByZXNwb25zZS50ZXh0XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gTWV0aG9kcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG4gIGdldFNlcnZpY2VDYWNoZSgpIHsgcmV0dXJuIHRoaXMuc2VydmljZUNhY2hlOyB9XHJcbiAgZ2V0Q2xvdWRNb2RlbENhY2hlKCkgeyByZXR1cm4gdGhpcy5jbG91ZE1vZGVsQ2FjaGU7IH1cclxuICBnZXRBcGlLZXlNaXNzaW5nTm90aWZpZWQoKSB7IHJldHVybiB0aGlzLmFwaUtleU1pc3NpbmdOb3RpZmllZDsgfVxyXG59IiwgIi8qXHJcbiAqIFRhc2sgcHJvY2Vzc2luZyBhbmQgZXh0cmFjdGlvbiBsb2dpY1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgVEZpbGUsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRXh0cmFjdG9yU2V0dGluZ3MsIFRhc2tFeHRyYWN0aW9uLCBUYXNrRXh0cmFjdGlvblJlc3VsdCwgRXh0cmFjdGVkVGFzayB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBMTE1Qcm92aWRlck1hbmFnZXIgfSBmcm9tICcuL2xsbS1wcm92aWRlcnMnO1xyXG5cclxuaW50ZXJmYWNlIFByb2Nlc3NpbmdTdGF0dXMge1xyXG4gIHN0YXR1czogJ3F1ZXVlZCcgfCAncHJvY2Vzc2luZycgfCAnY29tcGxldGVkJyB8ICdmYWlsZWQnO1xyXG4gIHN0YXJ0VGltZTogbnVtYmVyO1xyXG4gIHRpbWVvdXQ/OiBOb2RlSlMuVGltZW91dDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRhc2tQcm9jZXNzb3Ige1xyXG4gIHByaXZhdGUgcHJvY2Vzc2luZ0ZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICBwcml2YXRlIGZpbGVDaGFuZ2VEZWJvdW5jZXI6IE1hcDxzdHJpbmcsIE5vZGVKUy5UaW1lb3V0PiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIHByb2Nlc3NpbmdRdWV1ZTogTWFwPHN0cmluZywgUHJvY2Vzc2luZ1N0YXR1cz4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBhcHA6IEFwcCxcclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IEV4dHJhY3RvclNldHRpbmdzLFxyXG4gICAgcHJpdmF0ZSBsbG1Qcm92aWRlcjogTExNUHJvdmlkZXJNYW5hZ2VyXHJcbiAgKSB7fVxyXG5cclxuICAvLyBEZWJvdW5jZSBmaWxlIGNoYW5nZXMgdG8gcHJldmVudCByYXBpZCBwcm9jZXNzaW5nXHJcbiAgZGVib3VuY2VGaWxlQ2hhbmdlKGZpbGU6IFRGaWxlLCBjYWxsYmFjazogKGZpbGU6IFRGaWxlKSA9PiB2b2lkKSB7XHJcbiAgICBjb25zdCBleGlzdGluZyA9IHRoaXMuZmlsZUNoYW5nZURlYm91bmNlci5nZXQoZmlsZS5wYXRoKTtcclxuICAgIGlmIChleGlzdGluZykge1xyXG4gICAgICBjbGVhclRpbWVvdXQoZXhpc3RpbmcpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmZpbGVDaGFuZ2VEZWJvdW5jZXIuc2V0KGZpbGUucGF0aCwgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGNhbGxiYWNrKGZpbGUpO1xyXG4gICAgICB0aGlzLmZpbGVDaGFuZ2VEZWJvdW5jZXIuZGVsZXRlKGZpbGUucGF0aCk7XHJcbiAgICB9LCAyMDAwKSk7XHJcbiAgfVxyXG5cclxuICAvLyBXaGVuIGEgZmlsZSBpcyBjcmVhdGVkIG9yIG1vZGlmaWVkXHJcbiAgYXN5bmMgb25GaWxlQ2hhbmdlZChmaWxlOiBURmlsZSkge1xyXG4gICAgLy8gQXRvbWljIGZpbGUgcHJvY2Vzc2luZyB3aXRoIGd1YXJhbnRlZWQgY2xlYW51cCBhbmQgcXVldWUgbWFuYWdlbWVudFxyXG4gICAgaWYgKGZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSByZXR1cm47XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFscmVhZHkgaW4gcHJvY2Vzc2luZyBxdWV1ZSBvciBzZXRcclxuICAgIGNvbnN0IHF1ZXVlU3RhdHVzID0gdGhpcy5wcm9jZXNzaW5nUXVldWUuZ2V0KGZpbGUucGF0aCk7XHJcbiAgICBpZiAocXVldWVTdGF0dXM/LnN0YXR1cyA9PT0gJ3Byb2Nlc3NpbmcnIHx8IHRoaXMucHJvY2Vzc2luZ0ZpbGVzLmhhcyhmaWxlLnBhdGgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQWRkIHRvIHF1ZXVlIHdpdGggc3RhdHVzIHRyYWNraW5nXHJcbiAgICBjb25zdCBwcm9jZXNzaW5nU3RhdHVzOiBQcm9jZXNzaW5nU3RhdHVzID0ge1xyXG4gICAgICBzdGF0dXM6ICdxdWV1ZWQnLFxyXG4gICAgICBzdGFydFRpbWU6IERhdGUubm93KClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIEFkZCBwcm9jZXNzaW5nIHRpbWVvdXQgbWVjaGFuaXNtXHJcbiAgICBwcm9jZXNzaW5nU3RhdHVzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgY29uc29sZS53YXJuKGBUYXNrRXh0cmFjdG9yOiBGaWxlIHByb2Nlc3NpbmcgdGltZW91dCBmb3IgJHtmaWxlLnBhdGh9YCk7XHJcbiAgICAgIHRoaXMuY2xlYW51cEZpbGVQcm9jZXNzaW5nKGZpbGUucGF0aCk7XHJcbiAgICB9LCAzMDAwMCk7IC8vIDMwIHNlY29uZCB0aW1lb3V0XHJcbiAgICBcclxuICAgIHRoaXMucHJvY2Vzc2luZ1F1ZXVlLnNldChmaWxlLnBhdGgsIHByb2Nlc3NpbmdTdGF0dXMpO1xyXG4gICAgdGhpcy5wcm9jZXNzaW5nRmlsZXMuYWRkKGZpbGUucGF0aCk7XHJcbiAgICBcclxuICAgIC8vIFVwZGF0ZSBzdGF0dXMgdG8gcHJvY2Vzc2luZ1xyXG4gICAgcHJvY2Vzc2luZ1N0YXR1cy5zdGF0dXMgPSAncHJvY2Vzc2luZyc7XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgIGNvbnN0IGZyb250ID0gY2FjaGU/LmZyb250bWF0dGVyO1xyXG4gICAgICBpZiAoIWZyb250KSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBjaGVjayBhbHJlYWR5IHByb2Nlc3NlZFxyXG4gICAgICBjb25zdCBwcm9jZXNzZWRWYWx1ZSA9IHRoaXMuZ2V0RnJvbnRtYXR0ZXJWYWx1ZShmcm9udCwgdGhpcy5zZXR0aW5ncy5wcm9jZXNzZWRGcm9udG1hdHRlcktleSk7XHJcbiAgICAgIGlmIChwcm9jZXNzZWRWYWx1ZSA9PT0gdHJ1ZSB8fCBwcm9jZXNzZWRWYWx1ZSA9PT0gJ3RydWUnKSB7XHJcbiAgICAgICAgLy8gYWxyZWFkeSBwcm9jZXNzZWRcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHR5cGVSYXcgPSB0aGlzLmdldEZyb250bWF0dGVyVmFsdWUoZnJvbnQsICdUeXBlJykgfHwgJyc7XHJcbiAgICAgIGNvbnN0IHR5cGUgPSAoJycgKyB0eXBlUmF3KS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICBjb25zdCBhY2NlcHRlZCA9IHRoaXMuc2V0dGluZ3MudHJpZ2dlclR5cGVzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgIGlmICghYWNjZXB0ZWQuaW5jbHVkZXModHlwZSkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIHJlYWQgZmlsZSBjb250ZW50XHJcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cclxuICAgICAgLy8gY2FsbCBMTE1cclxuICAgICAgY29uc3QgZXh0cmFjdGlvbiA9IGF3YWl0IHRoaXMuZXh0cmFjdFRhc2tGcm9tQ29udGVudChjb250ZW50LCBmaWxlLnBhdGgpO1xyXG5cclxuICAgICAgaWYgKGV4dHJhY3Rpb24gJiYgZXh0cmFjdGlvbi5mb3VuZCkge1xyXG4gICAgICAgIC8vIEhhbmRsZSBib3RoIHNpbmdsZSB0YXNrIGFuZCBtdWx0aS10YXNrIHJlc3VsdHNcclxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVRhc2tFeHRyYWN0aW9uKGV4dHJhY3Rpb24sIGZpbGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBtYXJrIGFzIHByb2Nlc3NlZCBpZiBjb25maWd1cmVkXHJcbiAgICAgIGF3YWl0IHRoaXMubWFya0ZpbGVQcm9jZXNzZWQoZmlsZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBNYXJrIGFzIGNvbXBsZXRlZFxyXG4gICAgICBpZiAodGhpcy5wcm9jZXNzaW5nUXVldWUuaGFzKGZpbGUucGF0aCkpIHtcclxuICAgICAgICB0aGlzLnByb2Nlc3NpbmdRdWV1ZS5nZXQoZmlsZS5wYXRoKSEuc3RhdHVzID0gJ2NvbXBsZXRlZCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVGFza0V4dHJhY3RvciBlcnJvcicsIGVycik7XHJcbiAgICAgIG5ldyBOb3RpY2UoJ1Rhc2sgRXh0cmFjdG9yOiBlcnJvciBwcm9jZXNzaW5nIGZpbGUgXHUyMDE0IHNlZSBjb25zb2xlJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBNYXJrIGFzIGZhaWxlZFxyXG4gICAgICBpZiAodGhpcy5wcm9jZXNzaW5nUXVldWUuaGFzKGZpbGUucGF0aCkpIHtcclxuICAgICAgICB0aGlzLnByb2Nlc3NpbmdRdWV1ZS5nZXQoZmlsZS5wYXRoKSEuc3RhdHVzID0gJ2ZhaWxlZCc7XHJcbiAgICAgIH1cclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIC8vIEd1YXJhbnRlZWQgY2xlYW51cCAtIGFsd2F5cyBleGVjdXRlcyByZWdhcmRsZXNzIG9mIGVycm9ycyBvciBlYXJseSByZXR1cm5zXHJcbiAgICAgIHRoaXMuY2xlYW51cEZpbGVQcm9jZXNzaW5nKGZpbGUucGF0aCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBDZW50cmFsaXplZCBjbGVhbnVwIG1ldGhvZCBmb3IgYXRvbWljIHByb2Nlc3NpbmdcclxuICBwcml2YXRlIGNsZWFudXBGaWxlUHJvY2Vzc2luZyhmaWxlUGF0aDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdGF0dXMgPSB0aGlzLnByb2Nlc3NpbmdRdWV1ZS5nZXQoZmlsZVBhdGgpO1xyXG4gICAgaWYgKHN0YXR1cz8udGltZW91dCkge1xyXG4gICAgICBjbGVhclRpbWVvdXQoc3RhdHVzLnRpbWVvdXQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5wcm9jZXNzaW5nUXVldWUuZGVsZXRlKGZpbGVQYXRoKTtcclxuICAgIHRoaXMucHJvY2Vzc2luZ0ZpbGVzLmRlbGV0ZShmaWxlUGF0aCk7XHJcbiAgfVxyXG5cclxuICAvLyBzY2FuIHZhdWx0IG9uY2Ugb24gbG9hZCBmb3IgdW5wcm9jZXNzZWQgbWF0Y2hpbmcgbm90ZXNcclxuICBhc3luYyBzY2FuRXhpc3RpbmdGaWxlcygpIHtcclxuICAgIGNvbnN0IGZpbGVzID0gdGhpcy5nZXRVbnByb2Nlc3NlZEZpbGVzKCk7XHJcbiAgICBjb25zdCBiYXRjaGVzID0gdGhpcy5jaHVua0FycmF5KGZpbGVzLCA1KTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBiYXRjaCBvZiBiYXRjaGVzKSB7XHJcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKGJhdGNoLm1hcChmID0+IHRoaXMub25GaWxlQ2hhbmdlZChmKSkpO1xyXG4gICAgICBhd2FpdCB0aGlzLmRlbGF5KDEwMCk7IC8vIFByZXZlbnQgVUkgYmxvY2tpbmdcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEdldCBsaXN0IG9mIHVucHJvY2Vzc2VkIGZpbGVzIHRoYXQgbWF0Y2ggdHJpZ2dlciBjcml0ZXJpYVxyXG4gIHByaXZhdGUgZ2V0VW5wcm9jZXNzZWRGaWxlcygpOiBURmlsZVtdIHtcclxuICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgY29uc3QgdW5wcm9jZXNzZWRGaWxlczogVEZpbGVbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGYgb2YgZmlsZXMpIHtcclxuICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKTtcclxuICAgICAgY29uc3QgZnJvbnQgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XHJcbiAgICAgIGlmICghZnJvbnQpIGNvbnRpbnVlO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgdHlwZVJhdyA9IHRoaXMuZ2V0RnJvbnRtYXR0ZXJWYWx1ZShmcm9udCwgJ1R5cGUnKSB8fCAnJztcclxuICAgICAgY29uc3QgdHlwZSA9ICgnJyArIHR5cGVSYXcpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgIGNvbnN0IGFjY2VwdGVkID0gdGhpcy5zZXR0aW5ncy50cmlnZ2VyVHlwZXMubWFwKHQgPT4gdC50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgY29uc3QgcHJvY2Vzc2VkVmFsdWUgPSB0aGlzLmdldEZyb250bWF0dGVyVmFsdWUoZnJvbnQsIHRoaXMuc2V0dGluZ3MucHJvY2Vzc2VkRnJvbnRtYXR0ZXJLZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGFjY2VwdGVkLmluY2x1ZGVzKHR5cGUpICYmICEocHJvY2Vzc2VkVmFsdWUgPT09IHRydWUgfHwgcHJvY2Vzc2VkVmFsdWUgPT09ICd0cnVlJykpIHtcclxuICAgICAgICB1bnByb2Nlc3NlZEZpbGVzLnB1c2goZik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHVucHJvY2Vzc2VkRmlsZXM7XHJcbiAgfVxyXG5cclxuICAvLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNodW5rIGFycmF5IGludG8gc21hbGxlciBiYXRjaGVzXHJcbiAgcHJpdmF0ZSBjaHVua0FycmF5PFQ+KGFycmF5OiBUW10sIHNpemU6IG51bWJlcik6IFRbXVtdIHtcclxuICAgIGNvbnN0IGNodW5rczogVFtdW10gPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpICs9IHNpemUpIHtcclxuICAgICAgY2h1bmtzLnB1c2goYXJyYXkuc2xpY2UoaSwgaSArIHNpemUpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjaHVua3M7XHJcbiAgfVxyXG5cclxuICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciBkZWxheXNcclxuICBwcml2YXRlIGRlbGF5KG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0RnJvbnRtYXR0ZXJWYWx1ZShmcm9udDogYW55LCBrZXk6IHN0cmluZykge1xyXG4gICAgLy8gU3VwcG9ydCBuZXN0ZWQga2V5cyBsaWtlIFwidGFza0V4dHJhY3Rvci5wcm9jZXNzZWRcIlxyXG4gICAgaWYgKCFmcm9udCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIGlmIChrZXkuaW5jbHVkZXMoJy4nKSkge1xyXG4gICAgICBjb25zdCBwYXJ0cyA9IGtleS5zcGxpdCgnLicpO1xyXG4gICAgICBsZXQgY3VyID0gZnJvbnQ7XHJcbiAgICAgIGZvciAoY29uc3QgcCBvZiBwYXJ0cykge1xyXG4gICAgICAgIGlmICghY3VyKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGN1ciA9IGN1cltwXTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gY3VyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZyb250W2tleV07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIG1hcmtGaWxlUHJvY2Vzc2VkKGZpbGU6IFRGaWxlKSB7XHJcbiAgICBpZiAoIXRoaXMuc2V0dGluZ3MucHJvY2Vzc2VkRnJvbnRtYXR0ZXJLZXkpIHJldHVybjtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgb2ZmaWNpYWwgQVBJIGZvciBhdG9taWMgZnJvbnRtYXR0ZXIgcHJvY2Vzc2luZ1xyXG4gICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XHJcbiAgICAgICAgLy8gSGFuZGxlIG5lc3RlZCBrZXlzIChlLmcuLCBcInRhc2tFeHRyYWN0b3IucHJvY2Vzc2VkXCIpXHJcbiAgICAgICAgY29uc3Qga2V5cyA9IHRoaXMuc2V0dGluZ3MucHJvY2Vzc2VkRnJvbnRtYXR0ZXJLZXkuc3BsaXQoJy4nKTtcclxuICAgICAgICBsZXQgY3VycmVudCA9IGZyb250bWF0dGVyO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE5hdmlnYXRlIHRvIHRoZSBuZXN0ZWQgcHJvcGVydHksIGNyZWF0aW5nIG9iamVjdHMgYXMgbmVlZGVkXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTtcclxuICAgICAgICAgIGlmICghY3VycmVudFtrZXldIHx8IHR5cGVvZiBjdXJyZW50W2tleV0gIT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRba2V5XSA9IHt9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRba2V5XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2V0IHRoZSBmaW5hbCBwcm9wZXJ0eVxyXG4gICAgICAgIGN1cnJlbnRba2V5c1trZXlzLmxlbmd0aCAtIDFdXSA9IHRydWU7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBtYXJrIGZpbGUgcHJvY2Vzc2VkIHdpdGggb2ZmaWNpYWwgQVBJOicsIGUpO1xyXG4gICAgICAvLyBGYWxsYmFjayB0byBwcmV2aW91cyBtZXRob2QgaWYgdGhlIG9mZmljaWFsIEFQSSBmYWlsc1xyXG4gICAgICBhd2FpdCB0aGlzLm1hcmtGaWxlUHJvY2Vzc2VkRmFsbGJhY2soZmlsZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBGYWxsYmFjayBtZXRob2QgdXNpbmcgdGhlIHByZXZpb3VzIGltcGxlbWVudGF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBtYXJrRmlsZVByb2Nlc3NlZEZhbGxiYWNrKGZpbGU6IFRGaWxlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgY29uc3QgZm1NYXRjaCA9IGNvbnRlbnQubWF0Y2goL14tLS1cXG4oW1xcc1xcU10qPylcXG4tLS0vKTtcclxuICAgICAgbGV0IG5ld0NvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgICBpZiAoZm1NYXRjaCkge1xyXG4gICAgICAgIGNvbnN0IGZtID0gZm1NYXRjaFsxXTtcclxuICAgICAgICBjb25zdCBwcm9jZXNzZWRLZXkgPSB0aGlzLnNldHRpbmdzLnByb2Nlc3NlZEZyb250bWF0dGVyS2V5O1xyXG4gICAgICAgIC8vIGlmIGFscmVhZHkgcHJlc2VudCwgc2tpcFxyXG4gICAgICAgIGlmICghbmV3IFJlZ0V4cCgnXicgKyBwcm9jZXNzZWRLZXkucmVwbGFjZSgnLicsICdcXFxcLicpICsgJzonLCAnbScpLnRlc3QoZm0pKSB7XHJcbiAgICAgICAgICBjb25zdCBsaW5lcyA9IGZtLnNwbGl0KCdcXG4nKTtcclxuICAgICAgICAgIGxpbmVzLnB1c2goYCR7cHJvY2Vzc2VkS2V5fTogdHJ1ZWApO1xyXG4gICAgICAgICAgY29uc3QgdXBkYXRlZEZtID0gbGluZXMuam9pbignXFxuJyk7XHJcbiAgICAgICAgICBuZXdDb250ZW50ID0gY29udGVudC5yZXBsYWNlKGZtTWF0Y2hbMF0sIGAtLS1cXG4ke3VwZGF0ZWRGbX1cXG4tLS1gKTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gbm8gZnJvbnRtYXR0ZXIgXHUyMDE0IGNyZWF0ZSBvbmVcclxuICAgICAgICBjb25zdCBwcm9jZXNzZWRLZXkgPSB0aGlzLnNldHRpbmdzLnByb2Nlc3NlZEZyb250bWF0dGVyS2V5O1xyXG4gICAgICAgIG5ld0NvbnRlbnQgPSBgLS0tXFxuJHtwcm9jZXNzZWRLZXl9OiB0cnVlXFxuLS0tXFxuXFxuYCArIGNvbnRlbnQ7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIG1hcmsgZmlsZSBwcm9jZXNzZWQgd2l0aCBmYWxsYmFjayBtZXRob2Q6JywgZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTaGFyZWQgbWV0aG9kIGZvciBjb25zdHJ1Y3RpbmcgcHJvbXB0c1xyXG4gIHByaXZhdGUgYnVpbGRFeHRyYWN0aW9uUHJvbXB0KHNvdXJjZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogeyBzeXN0ZW06IHN0cmluZywgdXNlcjogc3RyaW5nIH0ge1xyXG4gICAgLy8gVXNlIGN1c3RvbSBwcm9tcHQgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgZW5oYW5jZWQgZGVmYXVsdFxyXG4gICAgY29uc3QgYmFzZVByb21wdCA9IHRoaXMuc2V0dGluZ3MuY3VzdG9tUHJvbXB0IHx8IFxyXG4gICAgICBgWW91IGFyZSBhIHRhc2sgZXh0cmFjdGlvbiBzcGVjaWFsaXN0LiBFeHRyYWN0IGFjdGlvbmFibGUgdGFza3MgZnJvbSBlbWFpbHMgYW5kIG1lZXRpbmcgbm90ZXMgZm9sbG93aW5nIHRoZXNlIHN0cmljdCBydWxlczpcclxuXHJcbkVYVFJBQ1RJT04gUlVMRVM6XHJcbi0gRXh0cmFjdCBPTkxZIGNvbmNyZXRlLCBhY3Rpb25hYmxlIHRhc2tzIGV4cGxpY2l0bHkgc3RhdGVkIG9yIGNsZWFybHkgaW1wbGllZFxyXG4tIFVzZSBudWxsIGZvciB1bmNlcnRhaW4vbWlzc2luZyBpbmZvcm1hdGlvbiAtIERPIE5PVCBHVUVTU1xyXG4tIEV4dHJhY3QgdGFza3Mgb25seSBmb3IgdGhlIHNwZWNpZmllZCBwZXJzb246ICR7dGhpcy5zZXR0aW5ncy5vd25lck5hbWV9IChleGFjdCBuYW1lKVxyXG4tIElmIG5vIGNsZWFyIHRhc2tzIGV4aXN0LCByZXR1cm4ge1wiZm91bmRcIjogZmFsc2UsIFwidGFza3NcIjogW119XHJcblxyXG5QUklPUklUWSBHVUlERUxJTkVTOlxyXG4tIGhpZ2g6IGV4cGxpY2l0IHVyZ2VuY3kvZGVhZGxpbmUgbWVudGlvbmVkXHJcbi0gbWVkaXVtOiBzdGFuZGFyZCByZXF1ZXN0cyB3aXRob3V0IHRpbWUgcHJlc3N1cmUgIFxyXG4tIGxvdzogb3B0aW9uYWwvYmFja2dyb3VuZCBpdGVtc1xyXG5cclxuVkFMSURBVElPTiBDT05TVFJBSU5UUzpcclxuLSB0YXNrX3RpdGxlOiA2LTEwMCBjaGFyYWN0ZXJzLCBhY3Rpb25hYmxlIHBocmFzaW5nXHJcbi0gdGFza19kZXRhaWxzOiBtYXggMzAwIGNoYXJhY3RlcnMsIGNvbmNyZXRlIGRlc2NyaXB0aW9uXHJcbi0gZHVlX2RhdGU6IFlZWVktTU0tREQgZm9ybWF0IG9ubHkgaWYgZXhwbGljaXRseSBtZW50aW9uZWRcclxuLSBzb3VyY2VfZXhjZXJwdDogZXhhY3QgcXVvdGUgKG1heCAxNTAgY2hhcnMpIGp1c3RpZnlpbmcgZXh0cmFjdGlvblxyXG5cclxuUmV0dXJuIHZhbGlkIEpTT04gb25seS4gQmUgY29uc2VydmF0aXZlIC0gYWNjdXJhY3kgb3ZlciBjb21wbGV0ZW5lc3MuYDtcclxuICAgIFxyXG4gICAgLy8gR2VuZXJhdGUgZmllbGQgZGVzY3JpcHRpb25zIGZyb20gZnJvbnRtYXR0ZXIgc2V0dGluZ3NcclxuICAgIGNvbnN0IGZpZWxkRGVzY3JpcHRpb25zID0gdGhpcy5zZXR0aW5ncy5mcm9udG1hdHRlckZpZWxkc1xyXG4gICAgICAuZmlsdGVyKGYgPT4gZi5yZXF1aXJlZCB8fCBmLmtleSA9PT0gJ3Rhc2tfdGl0bGUnIHx8IGYua2V5ID09PSAndGFza19kZXRhaWxzJylcclxuICAgICAgLm1hcChmID0+IHtcclxuICAgICAgICBpZiAoZi5rZXkgPT09ICd0YXNrJyB8fCBmLmtleSA9PT0gJ3Rhc2tfdGl0bGUnKSByZXR1cm4gJy0gdGFza190aXRsZTogc2hvcnQgKDYtMTAwIHdvcmRzKSBhY3Rpb25hYmxlIHRpdGxlJztcclxuICAgICAgICBpZiAoZi5rZXkgPT09ICd0YXNrX2RldGFpbHMnKSByZXR1cm4gJy0gdGFza19kZXRhaWxzOiAxLTMgc2VudGVuY2VzIGRlc2NyaWJpbmcgd2hhdCB0byBkbyBhbmQgYW55IGNvbnRleHQnO1xyXG4gICAgICAgIGlmIChmLmtleSA9PT0gJ2R1ZScpIHJldHVybiAnLSBkdWVfZGF0ZTogSVNPIGRhdGUgWVlZWS1NTS1ERCBpZiBleHBsaWNpdGx5IHByZXNlbnQgaW4gdGhlIHRleHQsIG90aGVyd2lzZSBudWxsJztcclxuICAgICAgICBpZiAoZi5rZXkgPT09ICdwcmlvcml0eScpIHJldHVybiBgLSBwcmlvcml0eTogJHtmLm9wdGlvbnM/LmpvaW4oJ3wnKSB8fCAnaGlnaHxtZWRpdW18bG93J30gKGNob29zZSBiZXN0IG1hdGNoKWA7XHJcbiAgICAgICAgaWYgKGYua2V5ID09PSAncHJvamVjdCcpIHJldHVybiAnLSBwcm9qZWN0OiBwcm9qZWN0IG5hbWUgaWYgbWVudGlvbmVkLCBvdGhlcndpc2UgbnVsbCc7XHJcbiAgICAgICAgaWYgKGYua2V5ID09PSAnY2xpZW50JykgcmV0dXJuICctIGNsaWVudDogY2xpZW50IG5hbWUgaWYgbWVudGlvbmVkLCBvdGhlcndpc2UgbnVsbCc7XHJcbiAgICAgICAgcmV0dXJuIGAtICR7Zi5rZXl9OiAke2YuZGVmYXVsdFZhbHVlIHx8ICdhcHByb3ByaWF0ZSB2YWx1ZSBiYXNlZCBvbiBjb250ZXh0J31gO1xyXG4gICAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3Qgc3lzdGVtID0gYCR7YmFzZVByb21wdH1cclxuXHJcbldoZW4gdGFza3MgYXJlIGZvdW5kLCByZXR1cm4gSlNPTiBpbiB0aGlzIGZvcm1hdDpcclxue1xyXG4gIFwiZm91bmRcIjogdHJ1ZSxcclxuICBcInRhc2tzXCI6IFtcclxuICAgIHtcclxuICAgICAgJHtmaWVsZERlc2NyaXB0aW9ucy5qb2luKCcsXFxuICAgICAgJyl9LFxyXG4gICAgICBcInNvdXJjZV9leGNlcnB0XCI6IFwiZXhhY3QgcXVvdGUgZnJvbSBzb3VyY2UgKG1heCAxNTAgY2hhcnMpXCIsXHJcbiAgICAgIFwiY29uZmlkZW5jZVwiOiBcImhpZ2h8bWVkaXVtfGxvd1wiXHJcbiAgICB9XHJcbiAgXSxcclxuICBcImNvbmZpZGVuY2VcIjogXCJoaWdofG1lZGl1bXxsb3dcIlxyXG59XHJcblxyXG5XaGVuIG5vIHRhc2tzIGZvdW5kLCByZXR1cm46IHtcImZvdW5kXCI6IGZhbHNlLCBcInRhc2tzXCI6IFtdfWA7XHJcblxyXG4gICAgY29uc3QgdXNlciA9IGBTT1VSQ0VfUEFUSDogJHtzb3VyY2VQYXRofVxcbi0tLUJFR0lOIE5PVEUtLS1cXG4ke2NvbnRlbnR9XFxuLS0tRU5EIE5PVEUtLS1gO1xyXG5cclxuICAgIHJldHVybiB7IHN5c3RlbSwgdXNlciB9O1xyXG4gIH1cclxuXHJcbiAgLy8gTmV3IG1ldGhvZCBmb3IgbXVsdGktdGFzayBleHRyYWN0aW9uXHJcbiAgYXN5bmMgZXh0cmFjdE11bHRpcGxlVGFza3NGcm9tQ29udGVudChjb250ZW50OiBzdHJpbmcsIHNvdXJjZVBhdGg6IHN0cmluZyk6IFByb21pc2U8VGFza0V4dHJhY3Rpb25SZXN1bHQ+IHtcclxuICAgIGNvbnN0IHsgc3lzdGVtLCB1c2VyIH0gPSB0aGlzLmJ1aWxkRXh0cmFjdGlvblByb21wdChzb3VyY2VQYXRoLCBjb250ZW50KTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByYXcgPSBhd2FpdCB0aGlzLmxsbVByb3ZpZGVyLmNhbGxMTE0oc3lzdGVtLCB1c2VyKTtcclxuICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5zYWZlUGFyc2VKU09OKHJhdyk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXBhcnNlZCkgcmV0dXJuIHsgZm91bmQ6IGZhbHNlLCB0YXNrczogW10gfTtcclxuICAgICAgXHJcbiAgICAgIC8vIElmIGl0J3MgYWxyZWFkeSBpbiB0aGUgbmV3IGZvcm1hdCwgcmV0dXJuIGl0XHJcbiAgICAgIGlmICgndGFza3MnIGluIHBhcnNlZCAmJiBBcnJheS5pc0FycmF5KHBhcnNlZC50YXNrcykpIHtcclxuICAgICAgICByZXR1cm4gcGFyc2VkIGFzIFRhc2tFeHRyYWN0aW9uUmVzdWx0O1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb252ZXJ0IGxlZ2FjeSBmb3JtYXQgdG8gbmV3IGZvcm1hdFxyXG4gICAgICBpZiAoJ2ZvdW5kJyBpbiBwYXJzZWQgJiYgcGFyc2VkLmZvdW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGZvdW5kOiB0cnVlLFxyXG4gICAgICAgICAgdGFza3M6IFt7XHJcbiAgICAgICAgICAgIHRhc2tfdGl0bGU6IHBhcnNlZC50YXNrX3RpdGxlIHx8ICdVbnNwZWNpZmllZCB0YXNrJyxcclxuICAgICAgICAgICAgdGFza19kZXRhaWxzOiBwYXJzZWQudGFza19kZXRhaWxzIHx8ICcnLFxyXG4gICAgICAgICAgICBkdWVfZGF0ZTogcGFyc2VkLmR1ZV9kYXRlIHx8IG51bGwsXHJcbiAgICAgICAgICAgIHByaW9yaXR5OiBwYXJzZWQucHJpb3JpdHkgfHwgJ21lZGl1bScsXHJcbiAgICAgICAgICAgIHByb2plY3Q6IHBhcnNlZC5wcm9qZWN0IHx8IG51bGwsXHJcbiAgICAgICAgICAgIGNsaWVudDogcGFyc2VkLmNsaWVudCB8fCBudWxsLFxyXG4gICAgICAgICAgICBzb3VyY2VfZXhjZXJwdDogcGFyc2VkLnNvdXJjZV9leGNlcnB0IHx8ICcnLFxyXG4gICAgICAgICAgICBjb25maWRlbmNlOiBwYXJzZWQuY29uZmlkZW5jZSB8fCAnbWVkaXVtJ1xyXG4gICAgICAgICAgfV1cclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4geyBmb3VuZDogZmFsc2UsIHRhc2tzOiBbXSB9O1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdleHRyYWN0TXVsdGlwbGVUYXNrc0Zyb21Db250ZW50IGVycm9yJywgZSk7XHJcbiAgICAgIHJldHVybiB7IGZvdW5kOiBmYWxzZSwgdGFza3M6IFtdIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgdGFzayBleHRyYWN0aW9uIHJlc3VsdHMgKGJvdGggc2luZ2xlIGFuZCBtdWx0aS10YXNrKVxyXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlVGFza0V4dHJhY3Rpb24oZXh0cmFjdGlvbjogVGFza0V4dHJhY3Rpb24gfCBUYXNrRXh0cmFjdGlvblJlc3VsdCwgc291cmNlRmlsZTogVEZpbGUpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIENoZWNrIGlmIGl0J3MgdGhlIG5ldyBtdWx0aS10YXNrIGZvcm1hdFxyXG4gICAgICBpZiAoJ3Rhc2tzJyBpbiBleHRyYWN0aW9uICYmIEFycmF5LmlzQXJyYXkoZXh0cmFjdGlvbi50YXNrcykpIHtcclxuICAgICAgICBsZXQgY3JlYXRlZENvdW50ID0gMDtcclxuICAgICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgZXh0cmFjdGlvbi50YXNrcykge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVUYXNrTm90ZSh0YXNrLCBzb3VyY2VGaWxlKTtcclxuICAgICAgICAgICAgY3JlYXRlZENvdW50Kys7XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIHRhc2sgbm90ZSBmb3I6ICR7dGFzay50YXNrX3RpdGxlfWAsIGVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNyZWF0ZWRDb3VudCA+IDApIHtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoYFRhc2sgRXh0cmFjdG9yOiBjcmVhdGVkICR7Y3JlYXRlZENvdW50fSB0YXNrIG5vdGUke2NyZWF0ZWRDb3VudCAhPT0gMSA/ICdzJyA6ICcnfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBIYW5kbGUgbGVnYWN5IHNpbmdsZS10YXNrIGZvcm1hdFxyXG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlVGFza05vdGUoZXh0cmFjdGlvbiBhcyBUYXNrRXh0cmFjdGlvbiwgc291cmNlRmlsZSk7XHJcbiAgICAgICAgbmV3IE5vdGljZShgVGFzayBFeHRyYWN0b3I6IGNyZWF0ZWQgdGFzayBcIiR7ZXh0cmFjdGlvbi50YXNrX3RpdGxlfVwiYCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIHRhc2sgZXh0cmFjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgIG5ldyBOb3RpY2UoJ1Rhc2sgRXh0cmFjdG9yOiBlcnJvciBjcmVhdGluZyB0YXNrIG5vdGVzIFx1MjAxNCBzZWUgY29uc29sZScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ29tcG9zZSBwcm9tcHQsIGNhbGwgTExNLCBhbmQgcGFyc2UgcmVzcG9uc2UgKGxlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0VGFza0Zyb21Db250ZW50KGNvbnRlbnQ6IHN0cmluZywgc291cmNlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxUYXNrRXh0cmFjdGlvbj4ge1xyXG4gICAgY29uc3QgeyBzeXN0ZW0sIHVzZXIgfSA9IHRoaXMuYnVpbGRFeHRyYWN0aW9uUHJvbXB0KHNvdXJjZVBhdGgsIGNvbnRlbnQpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJhdyA9IGF3YWl0IHRoaXMubGxtUHJvdmlkZXIuY2FsbExMTShzeXN0ZW0sIHVzZXIpO1xyXG4gICAgICBjb25zdCBwYXJzZWQgPSB0aGlzLnNhZmVQYXJzZUpTT04ocmF3KTtcclxuICAgICAgaWYgKCFwYXJzZWQpIHJldHVybiB7IGZvdW5kOiBmYWxzZSB9O1xyXG4gICAgICBcclxuICAgICAgLy8gSGFuZGxlIG5ldyBtdWx0aS10YXNrIGZvcm1hdFxyXG4gICAgICBpZiAocGFyc2VkLnRhc2tzICYmIEFycmF5LmlzQXJyYXkocGFyc2VkLnRhc2tzKSkge1xyXG4gICAgICAgIC8vIFJldHVybiBmaXJzdCB0YXNrIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbiAgICAgICAgaWYgKHBhcnNlZC50YXNrcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBmaXJzdFRhc2sgPSBwYXJzZWQudGFza3NbMF07XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBmb3VuZDogdHJ1ZSxcclxuICAgICAgICAgICAgdGFza190aXRsZTogZmlyc3RUYXNrLnRhc2tfdGl0bGUgfHwgJ1Vuc3BlY2lmaWVkIHRhc2snLFxyXG4gICAgICAgICAgICB0YXNrX2RldGFpbHM6IGZpcnN0VGFzay50YXNrX2RldGFpbHMgfHwgJycsXHJcbiAgICAgICAgICAgIGR1ZV9kYXRlOiBmaXJzdFRhc2suZHVlX2RhdGUgfHwgbnVsbCxcclxuICAgICAgICAgICAgcHJpb3JpdHk6IGZpcnN0VGFzay5wcmlvcml0eSB8fCAnbWVkaXVtJyxcclxuICAgICAgICAgICAgc291cmNlX2V4Y2VycHQ6IGZpcnN0VGFzay5zb3VyY2VfZXhjZXJwdCB8fCAnJyxcclxuICAgICAgICAgICAgY29uZmlkZW5jZTogZmlyc3RUYXNrLmNvbmZpZGVuY2UsXHJcbiAgICAgICAgICAgIC4uLmZpcnN0VGFzayAvLyBJbmNsdWRlIGFueSBhZGRpdGlvbmFsIGV4dHJhY3RlZCBmaWVsZHNcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB7IGZvdW5kOiBmYWxzZSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gSGFuZGxlIGxlZ2FjeSBzaW5nbGUtdGFzayBmb3JtYXRcclxuICAgICAgaWYgKCFwYXJzZWQuZm91bmQpIHJldHVybiB7IGZvdW5kOiBmYWxzZSB9O1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGZvdW5kOiB0cnVlLFxyXG4gICAgICAgIHRhc2tfdGl0bGU6IHBhcnNlZC50YXNrX3RpdGxlIHx8IHBhcnNlZC50aXRsZSB8fCAnVW5zcGVjaWZpZWQgdGFzaycsXHJcbiAgICAgICAgdGFza19kZXRhaWxzOiBwYXJzZWQudGFza19kZXRhaWxzIHx8IHBhcnNlZC5kZXRhaWxzIHx8ICcnLFxyXG4gICAgICAgIGR1ZV9kYXRlOiBwYXJzZWQuZHVlX2RhdGUgfHwgbnVsbCxcclxuICAgICAgICBwcmlvcml0eTogcGFyc2VkLnByaW9yaXR5IHx8ICdtZWRpdW0nLFxyXG4gICAgICAgIHNvdXJjZV9leGNlcnB0OiBwYXJzZWQuc291cmNlX2V4Y2VycHQgfHwgJycsXHJcbiAgICAgICAgLi4ucGFyc2VkIC8vIEluY2x1ZGUgYW55IGFkZGl0aW9uYWwgZXh0cmFjdGVkIGZpZWxkc1xyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdleHRyYWN0VGFza0Zyb21Db250ZW50IGVycm9yJywgZSk7XHJcbiAgICAgIHJldHVybiB7IGZvdW5kOiBmYWxzZSB9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzYWZlUGFyc2VKU09OKHRleHQ6IHN0cmluZyB8IG51bGwpOiBUYXNrRXh0cmFjdGlvblJlc3VsdCB8IFRhc2tFeHRyYWN0aW9uIHwgbnVsbCB7XHJcbiAgICBpZiAoIXRleHQpIHJldHVybiBudWxsO1xyXG4gICAgXHJcbiAgICBsZXQgcGFyc2VkOiBhbnkgPSBudWxsO1xyXG4gICAgXHJcbiAgICAvLyB0cnkgZGlyZWN0IHBhcnNlXHJcbiAgICB0cnkge1xyXG4gICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKHRleHQpO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIC8vIGV4dHJhY3QgZmlyc3Qgey4uLn1cclxuICAgICAgY29uc3QgbSA9IHRleHQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xyXG4gICAgICBpZiAobSkge1xyXG4gICAgICAgIHRyeSB7IFxyXG4gICAgICAgICAgcGFyc2VkID0gSlNPTi5wYXJzZShtWzBdKTsgXHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAvLyB0cnkgdG8gZml4IGNvbW1vbiBpc3N1ZXM6IHNpbmdsZSBxdW90ZXMgLT4gZG91YmxlXHJcbiAgICAgICAgICBjb25zdCBmaXhlZCA9IG1bMF0ucmVwbGFjZSgvJy9nLCAnXCInKTtcclxuICAgICAgICAgIHRyeSB7IFxyXG4gICAgICAgICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKGZpeGVkKTsgXHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghcGFyc2VkIHx8IHR5cGVvZiBwYXJzZWQgIT09ICdvYmplY3QnKSByZXR1cm4gbnVsbDtcclxuICAgIFxyXG4gICAgLy8gVmFsaWRhdGUgYW5kIG5vcm1hbGl6ZSB0aGUgcGFyc2VkIHJlc3VsdFxyXG4gICAgcmV0dXJuIHRoaXMudmFsaWRhdGVBbmROb3JtYWxpemVQYXJzZWRSZXN1bHQocGFyc2VkKTtcclxuICB9XHJcbiAgXHJcbiAgcHJpdmF0ZSB2YWxpZGF0ZUFuZE5vcm1hbGl6ZVBhcnNlZFJlc3VsdChkYXRhOiBhbnkpOiBUYXNrRXh0cmFjdGlvblJlc3VsdCB8IFRhc2tFeHRyYWN0aW9uIHwgbnVsbCB7XHJcbiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICdvYmplY3QnIHx8IGRhdGEgPT09IG51bGwpIHJldHVybiBudWxsO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBmb3IgbmV3IG11bHRpLXRhc2sgZm9ybWF0XHJcbiAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSgndGFza3MnKSAmJiBBcnJheS5pc0FycmF5KGRhdGEudGFza3MpKSB7XHJcbiAgICAgIGNvbnN0IHZhbGlkVGFza3M6IEV4dHJhY3RlZFRhc2tbXSA9IFtdO1xyXG4gICAgICBcclxuICAgICAgZm9yIChjb25zdCB0YXNrIG9mIGRhdGEudGFza3MpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkVGFzayh0YXNrKSkge1xyXG4gICAgICAgICAgdmFsaWRUYXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgdGFza190aXRsZTogdGFzay50YXNrX3RpdGxlIHx8ICdVbnNwZWNpZmllZCB0YXNrJyxcclxuICAgICAgICAgICAgdGFza19kZXRhaWxzOiB0YXNrLnRhc2tfZGV0YWlscyB8fCAnJyxcclxuICAgICAgICAgICAgZHVlX2RhdGU6IHRhc2suZHVlX2RhdGUgfHwgbnVsbCxcclxuICAgICAgICAgICAgcHJpb3JpdHk6IHRhc2sucHJpb3JpdHkgfHwgJ21lZGl1bScsXHJcbiAgICAgICAgICAgIHByb2plY3Q6IHRhc2sucHJvamVjdCB8fCBudWxsLFxyXG4gICAgICAgICAgICBjbGllbnQ6IHRhc2suY2xpZW50IHx8IG51bGwsXHJcbiAgICAgICAgICAgIHNvdXJjZV9leGNlcnB0OiB0YXNrLnNvdXJjZV9leGNlcnB0IHx8ICcnLFxyXG4gICAgICAgICAgICBjb25maWRlbmNlOiB0YXNrLmNvbmZpZGVuY2UgfHwgJ21lZGl1bScsXHJcbiAgICAgICAgICAgIC4uLnRhc2tcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBmb3VuZDogZGF0YS5mb3VuZCA9PT0gdHJ1ZSAmJiB2YWxpZFRhc2tzLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgdGFza3M6IHZhbGlkVGFza3MsXHJcbiAgICAgICAgY29uZmlkZW5jZTogZGF0YS5jb25maWRlbmNlIHx8ICdtZWRpdW0nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSBsZWdhY3kgc2luZ2xlLXRhc2sgZm9ybWF0XHJcbiAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSgnZm91bmQnKSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGZvdW5kOiBkYXRhLmZvdW5kID09PSB0cnVlLFxyXG4gICAgICAgIHRhc2tfdGl0bGU6IGRhdGEudGFza190aXRsZSB8fCBkYXRhLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgIHRhc2tfZGV0YWlsczogZGF0YS50YXNrX2RldGFpbHMgfHwgZGF0YS5kZXRhaWxzIHx8ICcnLFxyXG4gICAgICAgIGR1ZV9kYXRlOiBkYXRhLmR1ZV9kYXRlIHx8IG51bGwsXHJcbiAgICAgICAgcHJpb3JpdHk6IGRhdGEucHJpb3JpdHkgfHwgJ21lZGl1bScsXHJcbiAgICAgICAgc291cmNlX2V4Y2VycHQ6IGRhdGEuc291cmNlX2V4Y2VycHQgfHwgJycsXHJcbiAgICAgICAgLi4uZGF0YVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgXHJcbiAgcHJpdmF0ZSBpc1ZhbGlkVGFzayh0YXNrOiBhbnkpOiBib29sZWFuIHtcclxuICAgIGlmICh0eXBlb2YgdGFzayAhPT0gJ29iamVjdCcgfHwgIXRhc2spIHJldHVybiBmYWxzZTtcclxuICAgIFxyXG4gICAgLy8gTXVzdCBoYXZlIGEgdGFzayB0aXRsZVxyXG4gICAgaWYgKCF0YXNrLnRhc2tfdGl0bGUgfHwgdHlwZW9mIHRhc2sudGFza190aXRsZSAhPT0gJ3N0cmluZycgfHwgdGFzay50YXNrX3RpdGxlLnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBWYWxpZGF0ZSBjb25maWRlbmNlIGlmIHByZXNlbnRcclxuICAgIGlmICh0YXNrLmNvbmZpZGVuY2UgJiYgIVsnaGlnaCcsICdtZWRpdW0nLCAnbG93J10uaW5jbHVkZXModGFzay5jb25maWRlbmNlKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIHByaW9yaXR5IGlmIHByZXNlbnRcclxuICAgIGlmICh0YXNrLnByaW9yaXR5ICYmICFbJ2hpZ2gnLCAnbWVkaXVtJywgJ2xvdyddLmluY2x1ZGVzKHRhc2sucHJpb3JpdHkpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVmFsaWRhdGUgZHVlX2RhdGUgZm9ybWF0IGlmIHByZXNlbnRcclxuICAgIGlmICh0YXNrLmR1ZV9kYXRlICYmIHR5cGVvZiB0YXNrLmR1ZV9kYXRlID09PSAnc3RyaW5nJykge1xyXG4gICAgICBjb25zdCBkYXRlUmVnZXggPSAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC87XHJcbiAgICAgIGlmICghZGF0ZVJlZ2V4LnRlc3QodGFzay5kdWVfZGF0ZSkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvLyBDcmVhdGUgVGFza05vdGVzXHUyMDEzY29tcGF0aWJsZSBub3RlIGluIHRhc2tzRm9sZGVyXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVUYXNrTm90ZShleHRyYWN0aW9uOiBUYXNrRXh0cmFjdGlvbiB8IEV4dHJhY3RlZFRhc2ssIHNvdXJjZUZpbGU6IFRGaWxlKSB7XHJcbiAgICBjb25zdCBzYWZlVGl0bGUgPSB0aGlzLm1ha2VGaWxlbmFtZVNhZmUoZXh0cmFjdGlvbi50YXNrX3RpdGxlIHx8ICd0YXNrJyk7XHJcbiAgICBsZXQgZmlsZW5hbWUgPSBgJHtzYWZlVGl0bGV9Lm1kYDtcclxuICAgIGxldCBmb2xkZXIgPSB0aGlzLnNldHRpbmdzLnRhc2tzRm9sZGVyLnRyaW0oKSB8fCAnVGFza3MnO1xyXG4gICAgbGV0IHBhdGggPSBgJHtmb2xkZXJ9LyR7ZmlsZW5hbWV9YDtcclxuXHJcbiAgICAvLyBJZiBmaWxlIGV4aXN0cywgYXBwZW5kIGNvdW50ZXJcclxuICAgIGxldCBjb3VudGVyID0gMTtcclxuICAgIHdoaWxlICh0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCkpIHtcclxuICAgICAgcGF0aCA9IGAke2ZvbGRlcn0vJHtzYWZlVGl0bGV9LSR7Y291bnRlcn0ubWRgO1xyXG4gICAgICBjb3VudGVyKys7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgZnJvbnRtYXR0ZXIgdXNpbmcgY3VzdG9taXphYmxlIGZpZWxkc1xyXG4gICAgY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICBsaW5lcy5wdXNoKCctLS0nKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBmaWVsZCBvZiB0aGlzLnNldHRpbmdzLmZyb250bWF0dGVyRmllbGRzKSB7XHJcbiAgICAgIGxldCB2YWx1ZSA9IGV4dHJhY3Rpb25bZmllbGQua2V5XSB8fCBleHRyYWN0aW9uW2ZpZWxkLmtleS5yZXBsYWNlKCdfJywgJycpXSB8fCBmaWVsZC5kZWZhdWx0VmFsdWU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBIYW5kbGUgc3BlY2lhbCB2YWx1ZSByZXBsYWNlbWVudHNcclxuICAgICAgaWYgKHZhbHVlID09PSAne3tkYXRlfX0nKSB7XHJcbiAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gTWFwIGNvbW1vbiBleHRyYWN0aW9uIGtleXMgdG8gZmllbGQga2V5c1xyXG4gICAgICBpZiAoZmllbGQua2V5ID09PSAndGFzaycgJiYgIXZhbHVlICYmIGV4dHJhY3Rpb24udGFza190aXRsZSkge1xyXG4gICAgICAgIHZhbHVlID0gZXh0cmFjdGlvbi50YXNrX3RpdGxlO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAvLyBRdW90ZSBzdHJpbmcgdmFsdWVzIGFwcHJvcHJpYXRlbHlcclxuICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ3RleHQnICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUuaW5jbHVkZXMoJyAnKSkge1xyXG4gICAgICAgICAgbGluZXMucHVzaChgJHtmaWVsZC5rZXl9OiBcIiR7dmFsdWV9XCJgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbGluZXMucHVzaChgJHtmaWVsZC5rZXl9OiAke3ZhbHVlfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsaW5lcy5wdXNoKCctLS0nKTtcclxuICAgIGxpbmVzLnB1c2goJycpO1xyXG4gICAgbGluZXMucHVzaChleHRyYWN0aW9uLnRhc2tfZGV0YWlscyB8fCAnJyk7XHJcbiAgICBsaW5lcy5wdXNoKCcnKTtcclxuICAgIFxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MubGlua0JhY2spIHtcclxuICAgICAgY29uc3QgbGluayA9IGBbWyR7c291cmNlRmlsZS5wYXRofV1dYDtcclxuICAgICAgbGluZXMucHVzaChgU291cmNlOiAke2xpbmt9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChleHRyYWN0aW9uLnNvdXJjZV9leGNlcnB0KSB7XHJcbiAgICAgIGxpbmVzLnB1c2goJycpO1xyXG4gICAgICBsaW5lcy5wdXNoKCc+IEp1c3RpZmljYXRpb24gZXhjZXJwdDonKTtcclxuICAgICAgbGluZXMucHVzaCgnPiAnICsgZXh0cmFjdGlvbi5zb3VyY2VfZXhjZXJwdC5yZXBsYWNlKC9cXG4vZywgJyAnKSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZmluYWwgPSBsaW5lcy5qb2luKCdcXG4nKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUocGF0aCwgZmluYWwpO1xyXG4gICAgICBuZXcgTm90aWNlKGBUYXNrIEV4dHJhY3RvcjogY3JlYXRlZCB0YXNrIFwiJHtleHRyYWN0aW9uLnRhc2tfdGl0bGV9XCJgKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSB0YXNrIG5vdGUnLCBlKTtcclxuICAgICAgbmV3IE5vdGljZSgnVGFzayBFeHRyYWN0b3I6IGZhaWxlZCB0byBjcmVhdGUgdGFzayBub3RlIFx1MjAxNCBzZWUgY29uc29sZScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBtYWtlRmlsZW5hbWVTYWZlKHRpdGxlOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiB0aXRsZS5yZXBsYWNlKC9bXFxcXC86Kj9cIjw+fCMle31cXFxcXn5cXFtcXF1gOydAJj0rXS9nLCAnJykucmVwbGFjZSgvXFxzKy9nLCAnLScpLnNsaWNlKDAsIDEyMCk7XHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCBjbGVhbnVwIG1ldGhvZCB3aXRoIHByb2Nlc3NpbmcgcXVldWUgbWFuYWdlbWVudFxyXG4gIGNsZWFudXAoKSB7XHJcbiAgICAvLyBDbGVhciBkZWJvdW5jZSB0aW1lcnNcclxuICAgIHRoaXMuZmlsZUNoYW5nZURlYm91bmNlci5mb3JFYWNoKHRpbWVvdXQgPT4gY2xlYXJUaW1lb3V0KHRpbWVvdXQpKTtcclxuICAgIHRoaXMuZmlsZUNoYW5nZURlYm91bmNlci5jbGVhcigpO1xyXG4gICAgXHJcbiAgICAvLyBDbGVhciBwcm9jZXNzaW5nIHF1ZXVlIHRpbWVyc1xyXG4gICAgdGhpcy5wcm9jZXNzaW5nUXVldWUuZm9yRWFjaChzdGF0dXMgPT4ge1xyXG4gICAgICBpZiAoc3RhdHVzLnRpbWVvdXQpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc3RhdHVzLnRpbWVvdXQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMucHJvY2Vzc2luZ1F1ZXVlLmNsZWFyKCk7XHJcbiAgICBcclxuICAgIC8vIENsZWFyIHByb2Nlc3NpbmcgZmlsZXMgc2V0XHJcbiAgICB0aGlzLnByb2Nlc3NpbmdGaWxlcy5jbGVhcigpO1xyXG4gIH1cclxuXHJcbiAgLy8gTWV0aG9kcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG4gIGdldFByb2Nlc3NpbmdGaWxlcygpIHsgcmV0dXJuIHRoaXMucHJvY2Vzc2luZ0ZpbGVzOyB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBWUEsSUFBQUEsbUJBQTZFOzs7QUNrRXRFLElBQU0sNkJBQWlEO0FBQUEsRUFDNUQsRUFBRSxLQUFLLFFBQVEsY0FBYyxJQUFJLE1BQU0sUUFBUSxVQUFVLEtBQUs7QUFBQSxFQUM5RCxFQUFFLEtBQUssVUFBVSxjQUFjLFNBQVMsTUFBTSxVQUFVLFNBQVMsQ0FBQyxTQUFTLFFBQVEsV0FBVyxXQUFXLFFBQVEsV0FBVyxHQUFHLFVBQVUsS0FBSztBQUFBLEVBQzlJLEVBQUUsS0FBSyxZQUFZLGNBQWMsVUFBVSxNQUFNLFVBQVUsU0FBUyxDQUFDLE9BQU8sVUFBVSxRQUFRLFFBQVEsR0FBRyxVQUFVLEtBQUs7QUFBQSxFQUN4SCxFQUFFLEtBQUssT0FBTyxjQUFjLElBQUksTUFBTSxRQUFRLFVBQVUsTUFBTTtBQUFBLEVBQzlELEVBQUUsS0FBSyxXQUFXLGNBQWMsSUFB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
